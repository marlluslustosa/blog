
var documents = [{
    "id": 0,
    "url": "http://localhost:4000/404.html",
    "title": "404",
    "body": "404 Page does not exist!Please use the search bar at the top or visit our homepage! "
    }, {
    "id": 1,
    "url": "http://localhost:4000/about",
    "title": "About me",
    "body": "I am a Bachelor in Computer Science at the Federal University of Piauí (UFPI) and master’s degree in Public Policies and Management of Higher Education at the Federal University of Ceará (UFC). I work as an IT Analyst in this same institution (UFC) working in the areas of virtualization and cloud. I have acted (and still work) as a teacher in the area of computing. But for some time now I am immersing myself in agroecology, ecology, data science, connectivism, cryptocoins, blockchain, social capital, political activism and free and open source software, as well as contributing to projects and ideas that really matter for a democratic internet. I’m a Tor, ZeroNet, Subutai, XCP-ng and federated networks enthusiast. Currently, my newest hobby are Generative Adversary Networks (GANs) as a tool for generating art. Check out my Instagram. 	Skills*   PHP/JS/Python/C* Digital art * 	  Neural Networks*   Network computer	* 	Data science* DevOps*   Containers*   Virtualization/Cloud* Blockchain* Teaching * Writing  "
    }, {
    "id": 2,
    "url": "http://localhost:4000/busca",
    "title": "Busca",
    "body": " Título, tag, descrição, conteúdo ou data de publicação (2020, 2016-02, 2016-07-21).  "
    }, {
    "id": 3,
    "url": "http://localhost:4000/categories",
    "title": "Categories",
    "body": ""
    }, {
    "id": 4,
    "url": "http://localhost:4000/contact",
    "title": "Secure Message",
    "body": "Send me a secure message using my PGP Public Key. Type the message below and click Encrypt. After that, copy the generated text and send it to me by e-mail, telegram, instagram or any other form of textual communication. Only i will be able to open the message. Encrypt Copy		The above encryption was performed through the library OpenPGP. js, maintained by ProtonMail. 						 "
    }, {
    "id": 5,
    "url": "http://localhost:4000/contato",
    "title": "Secure Message",
    "body": "Me envie uma mensagem segura, usando minha chave Pública PGP. Digite a mensagem abaixo e clique em Encrypt.  	Após isso, copie o texto gerado e me envie por e-mail, telegram, instagram ou qualquer outra forma de comunicação textual. 	Somente eu conseguirei abrir a mensagem. 	Encrypt Copy		A cifragem acima foi realizada através da biblioteca OpenPGP. js, mantida pelo ProtonMail. 						 "
    }, {
    "id": 6,
    "url": "http://localhost:4000/index-pt_BR.html",
    "title": "Home",
    "body": "      Todas as histórias:             "
    }, {
    "id": 7,
    "url": "http://localhost:4000/",
    "title": "Home",
    "body": "        Destaque:                                                                                                                                                                                                                                                                                                 P2V / V2V – Conversão de ambientes – XenServer 6. 5                                                                                  tecnologia                                                                	                              :               Bem, P2V e V2V são termos que remetem à migração de sistemas. E migração (desde antes de cristo – 40 anos de migração dos hebreus. . . :                                                                                                                                                                                       Marllus                                                17 Feb 2016                                                                                                                                                                                                                                                                                                                                                                                                                      Quando o WhatsApp acabou                                                                                  poesia                                                                	                              :               De manhã cedo, acordei… Peguei no celular, nenhuma notificação. Verifiquei o link de internet acessando um site qualquer. Estava beleza. O mito então era mesmo. . . :                                                                                                                                                                                       Marllus                                                18 Dec 2015                                                                                                                                          Todas as histórias:                                                                                                         Só me resta o grito                                                            arte                                                              :       Assim como as inquietações de Edvard Munch, que caminham entre doenças, vida e morte, tento descrever o momento único dessa ilustração a partir de suas pinceladas, onde podemos suscitar a. . . :                                                                                       Marllus                        15 May 2020                                                                                                                                             Meu pequeno xote                                                            poesia                                                              :       Não faço para crer, não digo para me sentir. É certo que a boca falao que não quero ver,mas enfia goela a dentro os devaneios alheios. :                                                                                       Marllus                        04 May 2020                                                                                                                                             Instalar Xenserver Tools (xen-tools) em Debian 5 (Lenny) (HVM para PV)                                                            tecnologia                                                              :       O tutorial de hoje é sobre como intalar o XenTools em uma VM Debian 5. 0 (Lenny) em um Xenserver que não tem suporte a mesma (support guests), como ocorre a. . . :                                                                                       Marllus                        21 Jul 2016                                                                                                                                             Véspera                                                            poesia                                                              :       Em pé nesse caminhoMe vejo insano e famintoO grito da catraca me atracaA ter vontade de esperar. :                                                                                       Marllus                        03 Jul 2016                                                                                                                                             XenMotion no XenServer 6. 5                                                            tecnologia                                                              :       XenMotion é um recurso bem interessante e muito importante dentro de ambiente de virtualização do XenServer. É com ele que o HA (High Availability), WLB (Work Load Balancing – Versão. . . :                                                                                       Marllus                        17 Feb 2016                                                                                                                                             Xencenter                                                            tecnologia                                                              :        O assunto agora é sobre gerenciamento do XenServer. Neste caso, falaremos sobre XenCenter, que é o software OFICIAL de gerência do XenServer. :                                                                                       Marllus                        17 Feb 2016                                                       &laquo; Prev       1        2        3        4        5      Next &raquo; "
    }, {
    "id": 8,
    "url": "http://localhost:4000/search.json",
    "title": "",
    "body": "[ {% for post in site. posts %}  {   “title”  : “{{ post. title | escape }}”,   “category” : “{{ post. category }}”,   “tags”   : “{{ post. tags | join: ‘, ‘ }}”,   “url”   : “{{ site. baseurl }}{{ post. url }}”,   “date”   : “{{ post. date }}”,   “content” : “{{ post. content | markdownify | strip_html | strip_newlines | escape_once }}”  } {% unless forloop. last %},{% endunless %} {% endfor %}] "
    }, {
    "id": 9,
    "url": "http://localhost:4000/search",
    "title": "Busca",
    "body": " Title, tag, description, content or publication date (2020, 2016-02, 2016-07-21).  "
    }, {
    "id": 10,
    "url": "http://localhost:4000/sobre",
    "title": "Sobre mim",
    "body": "Sou bacharel em Ciência da Computação pela Universidade Federal do Piauí (UFPI) e mestre em Políticas Públicas e Gestão do Ensino Superior pela Universidade Federal do Ceará (UFC). Trabalho como analista de TI nessa mesma instituição. Paralelamente, atuo como professor universtário em cursos de tecnologia da informação.  Mergulho sempre em tudo que achar interessante, como agroecologia, ciência de dados, conectivismo, criptomoedas, blockchain, capital social, ativismo político e software livre e de código aberto, além de contribuir para projetos e idéias que realmente importam para uma internet democrática. Sou entusiasta do Tor, ZeroNet, Subutai, XCP-ng e redes federadas. Atualmente, meu hobbie são as Redes Adversárias Generativas (GANs) como ferramenta para geração de arte. Confira meu Instagram. 	Habilidades*   PHP/JS/Python/C* Digital art * 	  Neural Networks*   Network computer	* 	Data science* DevOps*   Containers*   Virtualization/Cloud* Blockchain* Docência * Escrita "
    }, {
    "id": 11,
    "url": "http://localhost:4000/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ “sitemap. xml”   absolute_url }}   "
    }, {
    "id": 12,
    "url": "http://localhost:4000/page2/",
    "title": "Home",
    "body": "{% if page. url == “/” %}       {% if site. lang ==  en  %}    Featured:   {% else %}  Destaque:   {% endif %}      {% for post in site. posts %}    {% if post. featured == true %}      {% include featuredbox. html %}    {% endif %}  {% endfor %}  {% endif %}       {% if site. lang ==  en  %}    All stories:   {% else %}    Todas as histórias:   {% endif %}          {% for post in paginator. posts %}    {% include postbox. html %}    {% endfor %}    {% include pagination. html %}"
    }, {
    "id": 13,
    "url": "http://localhost:4000/page3/",
    "title": "Home",
    "body": "{% if page. url == “/” %}       {% if site. lang ==  en  %}    Featured:   {% else %}  Destaque:   {% endif %}      {% for post in site. posts %}    {% if post. featured == true %}      {% include featuredbox. html %}    {% endif %}  {% endfor %}  {% endif %}       {% if site. lang ==  en  %}    All stories:   {% else %}    Todas as histórias:   {% endif %}          {% for post in paginator. posts %}    {% include postbox. html %}    {% endfor %}    {% include pagination. html %}"
    }, {
    "id": 14,
    "url": "http://localhost:4000/page4/",
    "title": "Home",
    "body": "{% if page. url == “/” %}       {% if site. lang ==  en  %}    Featured:   {% else %}  Destaque:   {% endif %}      {% for post in site. posts %}    {% if post. featured == true %}      {% include featuredbox. html %}    {% endif %}  {% endfor %}  {% endif %}       {% if site. lang ==  en  %}    All stories:   {% else %}    Todas as histórias:   {% endif %}          {% for post in paginator. posts %}    {% include postbox. html %}    {% endfor %}    {% include pagination. html %}"
    }, {
    "id": 15,
    "url": "http://localhost:4000/page5/",
    "title": "Home",
    "body": "{% if page. url == “/” %}       {% if site. lang ==  en  %}    Featured:   {% else %}  Destaque:   {% endif %}      {% for post in site. posts %}    {% if post. featured == true %}      {% include featuredbox. html %}    {% endif %}  {% endfor %}  {% endif %}       {% if site. lang ==  en  %}    All stories:   {% else %}    Todas as histórias:   {% endif %}          {% for post in paginator. posts %}    {% include postbox. html %}    {% endfor %}    {% include pagination. html %}"
    }, {
    "id": 16,
    "url": "http://localhost:4000/arte/2020/05/15/so-me-resta-grito.html",
    "title": "Só me resta o grito",
    "body": "2020/05/15 - Assim como as inquietações de Edvard Munch, que caminham entre doenças, vida e morte, tento descrever o momento único dessa ilustração a partir de suas pinceladas, onde podemos suscitar a fragilidade e a transitoriedade da vida. Ao vigiar essa rua da cidade, temporariamente deserta, descobri um homem, arrastando seu objeto de trabalho, como se fosse em uma direção que nunca terá fim, um horizonte invisível. A loucura toma conta do ar, entremeada por agonia, rezas e rasga mortalhas, em um céu silencioso e de sangue. Estamos vivendo a passagem do próprio tempo. O sinal de pare pouco importa. Só me resta o grito. "
    }, {
    "id": 17,
    "url": "http://localhost:4000/poesia/2020/05/04/meu-pequeno-xote.html",
    "title": "Meu pequeno xote",
    "body": "2020/05/04 - Não faço para crer, não digo para me sentir. É certo que a boca falao que não quero ver,mas enfia goela a dentro os devaneios alheios. Ser o jeito que seria, se tivesse crédito,era a melhor coisa. Mas a vida é feito de regras. Más ou boas, sempre estarão lá,com o mesmo desafio de enterpretá-las,como que um farol, na tentativa de ver um homem urinando em sua base. O difícil está lá, mas também o fácil. Já falei da laranja e da faca e do João a cortando. A força, a leveza e a vontade é que vão dar o destino do ferimento. Só sei q nada sei, já falava Sócrates. Mas será q ele mesmo poderia ou já teria feito a pergunta: Será quando? "
    }, {
    "id": 18,
    "url": "http://localhost:4000/tecnologia/2016/07/21/instalar-xenserver-tools-xen-tools-em-debian-5-lenny-hvm-para-pv.html",
    "title": "Instalar Xenserver Tools (xen-tools) em Debian 5 (Lenny) (HVM para PV)",
    "body": "2016/07/21 - O tutorial de hoje é sobre como intalar o XenTools em uma VM Debian 5. 0 (Lenny) em um Xenserver que não tem suporte a mesma (support guests), como ocorre a partir da versão 6. 2. Bem, instalar o xen-tools vai habilitar o administrador a realizar diversas operações com a VM, como gerenciar a network da mesma, monitorar o uso de memória RAM, realizar Xen Motion além de fornecer drivers para otimização de I/O de disco e rede. As vezes, ocorre de você ter um sistema legado (ex. Debian 5. 0), exportado de um outro hypervisor ou de uma máquina física, no seu ambiente de virtualização. Baseado nesse tipo de situação, deixo aqui um tutorial de como facilmente você pode instalar o xen-tools nessa VM e de quebra realizar a paravirtualização da mesma (HVM para PV). Os passos a seguir mostram como instalar o xen-tools em um Debian 5 estando em um XenServer 7 – Dundee. Pode ser feito também em outras versões do XenServer, como 6. 2 e 6. 5. Primeiro, vamos baixar o xen tools do XenServer 6. 0 (Não é fácil encontrá-lo separado na internet, então instalei o mesmo e o peguei da pasta /opt/xensource/packages/iso/) e o coloquei em uma pasta pública para donwload. O link está abaixo: https://dl. dropboxusercontent. com/u/4912938/xentools6. 0. iso Com a VM ligada, baixe o arquivo para dentro da mesma. Abaixo cito um exemplo usando wget: # wget https://dl. dropboxusercontent. com/u/4912938/xentools6. 0. iso Após isso, monte o arquivo . iso: # mount -o loop xentools6. 0. iso /mnt OBS: O diretório /mnt foi colocado como exemplo. Se tiver outro diretório onde queira montar, altere-o. Entre no diretório de execução do script do xen-tools e execute-o: # cd /mnt/Linux/ # . /install O script vai gerar um informação na tela relatando que reconheceu o sistema operacional Debian 5. 0 e que vai atualizar diversos arquivos, incluindo o kernel do sistema (que é um kernel paravirtualizado). Pressione a tecla ‘y’ para confirmar a instalação e configuração. Aguarde um instante e logo terminará a instalação. No final do relatório o testo irá relatar para reiniciar a VM. NÃO REINICIE AINDA. NÃO REINICIE AINDA. NÃO REINICIE AINDA. Se você reiniciar, o sistema não vai iniciar, pois ainda faltam configurações adicionais para o boot conseguir ser realizado. Primeiro, entre no arquivo de configuração da inicialização do grub. # vim /boot/grub/menu. lst No meu caso, o script do xen-tools instalou o kernel 2. 6. 32-5-amd64,  e o mesmo adicionou como partição do arquivo initrd e kernel a /dev/hda1. A forma que o XenServer utiliza para gerenciar dispositivos de bloco virtuais de VMs é a xvda/xvdb… ao invés de hda/hdb… ou sda/sdb…. É aí que surge o problema. Se você deixar /dev/hda, quando o boot da VM ocorrer ele tentará iniciar o kernel paravirtualizado 2. 6. 32-5-amd64 e não irá conseguir, pois o mesmo está referenciado por /dev/xvd*, por isso, temos que alterar no arquivo do grub. A imagem abaixo é para mostrar como ficará o arquivo menu. lst. Percebam o ‘root=/dev/xvda1’ para mostrar que o novo dispositivo de bloco que contém o kernel e initrd estão nesse dispositivo de bloco.    No kernel antigo (2. 6. 26-2-amd64) podem deixar como está, pois não mais precisaremos dele. Saia e salve o arquivo: Tecle Esc e digite: :w! Agora vá para o arquivo padrão de montagem de partições para atualizar o novo nome: # vim /etc/fstab Altere todas as linhas que contém /dev/hdx* por /dev/xvdx*. OBS: Substitua o ‘x’ pela letra correspondente ao dispositivo de bloco correspondente e o * pelo número referente a partição. No meu caso exemplo, o arquivo ficou dessa forma: Salve e saia do arquivo: Tecle esc e digite: :w! Agora, iremos alterar o console padrão do sistema (tty) para o padrão do XenServer (hvc): Entre no arquivo /etc/inittab: # vim /etc/inittab Adicione a linha: co:2345:respawn:/sbin/getty hvc0 9600 linux antes da linha: 1:2345:respawn:/sbin/getty/ 38400 tty1 Agora tenha em mãos o uuid da VM (você pode vê-lo através do xencenter na aba _General _da VM no canto inferior. ) Abra o console do XenServer e digite os comandos abaixo: Setar o novo kernel e initrd da VM: _# xe vm-param-set uuid= PV-bootloader-args=&#8221;&#8211;kernel &#8211;ramdisk &#8221; _ No meu caso ficou assim: # _xe vm-param-set uuid= PV-bootloader-args=&#8221;&#8211;kernel /boot/vmlinuz-2. 6. 32-5-amd64 &#8211;ramdisk /boot/initrd. img-2. 6. 32-5-amd64&#8243;_ Setar o local dos arquivos do kernel e initrd da VM: # xe vm-param-set uuid=_ PV-args=&#8221;root=/dev/xvdx* ro quiet console=hvc0&#8243; _ No meu caso ficou assim: _# xe vm-param-set uuid=____ PV-args=&#8221;root=/dev/xvda1 ro quiet console=hvc0&#8243;_ Setar o novo bootloader (grub) da VM: _# xe vm-param-set uuid= PV-bootloader=pygrub_ Setar em branco o boot antigo (HVM): # _xe vm-param-set uuid= HVM-boot-policy=&#8221;&#8221;_ Pronto, após todos os comandos sem nenhum erro, você pode reinicializar a VM. Caso ocorra tudo bem, quando a mesma estiver ativa, no xencenter na aba General veja seu estado de virtualização  (Virtualization state) e veja se está com status Optimized. Isso quer dizer que o xen-tools está instalado. Para saber se a VM está rodando em modo PV, no campo “Virtualization mode” vai estar escrito PV. Caso esteja utilizando o XenServer 6. 5 ou 6. 2 digite o comando abaixo dentro da VM:       # dmesg   egrep -i “xen   front”   Se ela estiver em PV (paravirtualizada), as seguintes linhas aparecerão, dentre outras informações: … Booting paravirtualized kernel on Xen … blkfront: xvda: barriers enable Initialising Xen virtual ethernet drive Abaixo deixo o print da tela de opções que serão habilitadas com o xen-tools instalado: Chegamos ao fim, enfim. Grande abraço e qualquer dúvida poste nos comentários ou mande e-mail (marlluslustosa@gmail. com). Se quiser ter acesso a uma série de tutorias sobre diversas funcionalidades do XenServer, acesse a página inicial do projeto: http://www. marllus. com/xenserver Referências: http://discussions. citrix. com/topic/307891-paravirtualizing-debian/ http://discussions. citrix. com/topic/151259-howto-convert-hvm-to-paravirtmanual-p2v-rhel5sles10sp1/ http://support. citrix. com/article/CTX121875 http://discussions. citrix. com/topic/259891-tut-debian-lenny-paravirtualization-with-xentools-updated/ "
    }, {
    "id": 19,
    "url": "http://localhost:4000/poesia/2016/07/03/vespera.html",
    "title": "Véspera",
    "body": "2016/07/03 - Em pé nesse caminhoMe vejo insano e famintoO grito da catraca me atracaA ter vontade de esperar. Joãos e MariasNa esperança da fina endorfinaSe na Terça vem paçocaSe na quarta vem linguiça. Os meios são nexosO caminho é certoA multidão é limpaDepois das 12, encrenca. Mas que não falte a comida. E ao chegar perto a tripa aperta. Com os olhos lá dentro,A saliva acomete e a vontade é certa,Na véspera. Os meios sao nexosO caminho é certoA multidão é limpaDepois das 12, encrenca. Mas que não falte a comida. Eita q eu vou entrar, será?Tem mais um bolinho ali. Que horas me farto? Que fardo!Vamo sim, é agora! Vamo que é hora! "
    }, {
    "id": 20,
    "url": "http://localhost:4000/tecnologia/2016/02/17/xenmotion-no-xenserver-6-5.html",
    "title": "XenMotion no XenServer 6.5",
    "body": "2016/02/17 - XenMotion é um recurso bem interessante e muito importante dentro de ambiente de virtualização do XenServer. É com ele que o HA (High Availability), WLB (Work Load Balancing – Versão paga do XenServer – 🙁  ) e Rolling Pool Upgrade funcionam direitinho, habilitando a possibilidade de mover as VMs entre hosts do mesmo pool sem (ou quase sem) downtime (geralmente 1 ou 2 pings perdidos). O XenMotion já vem habilitado no XenServer na versão gratuita. E ele serve, basicamente (e como falei acima), para você poder movimentar VMs “à quente” entre hosts xen em um mesmo pool, ou seja, o storage (SR) têm de ser compartilhado entre as VMs (Geralmente um storage, adicionado em um pool, do tipo iscsi, fc, nfs). Mas, quais os requisitos mais específicos para utilizar o XenMotion? – O XenServer tools deve estar instalado na VM; – O host xen destino têm de ter a mesma ou versão superior do XenServer do host de origem; – O host xen destino têm que ter memória suficiente para o provisionamento da VM, caso contrário a VM não completará o processo de migração (isso é meio lógico, rs); – O drive de DVD deve estar setado como empty (não deve ter nenhuma . iso anexada ou nenhum cd/dvd dentro do drive do host físico); – Ter um SR compartilhado no pool (NFS, iSCSI/FC SAN); Mas, e em quais situações você vai usar o XenMotion (fora ficar brincando de jogar uma VM de um host pra outro só pra ver como é lindo isso funcionando, rs)? Você pode usar isso, por exemplo, quando for atualizar um host xen, migrando as VMs nele contidas para um outro host xen. Além disso, você pode usar pra migrar VMs enquanto faz manutenção em um host ou até planejar um script balanceador de carga entre hosts físicos (o que o Work Loading Balancig faz – na versão do Xenserver com linceça). Enfim, as possibilidades são muitas. Só a produção e o dia a dia que vai te desafiar com situações como estas. É só pensar sobre os benefícios e planejá-los bem! Para saber como migrar uma VM através do XenCenter, acesse esse tutorial (http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-manage/xs-xc-vms-relocate. html). Tutoriais/ explicações em vídeo: https://www. youtube. com/watch?v=hTlwlNjc86M https://www. youtube. com/watch?v=05Zc0ze5CpQ https://www. youtube. com/watch?v=vcPzrnrnYCU Até breve! Abraço!   Referências: http://support. citrix. com/article/CTX115813 http://www. amazon. com. br/Mastering-Citrix-Xenserver-Martez-Reed/dp/178328739X http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-manage/xs-xc-vms-relocate. html https://msinhore. wordpress. com/2012/09/20/storage-xenmotion/ https://www. youtube. com/watch?v=hTlwlNjc86M https://www. youtube. com/watch?v=05Zc0ze5CpQ https://www. youtube. com/watch?v=vcPzrnrnYCU https://www. citrix. com/content/dam/citrix/en_us/documents/products-solutions/storage-xenmotion-live-storage-migration-with-citrix-xenserver. pdf?accessmode=direct    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 21,
    "url": "http://localhost:4000/tecnologia/2016/02/17/xencenter.html",
    "title": "Xencenter",
    "body": "2016/02/17 -  O assunto agora é sobre gerenciamento do XenServer. Neste caso, falaremos sobre XenCenter, que é o software OFICIAL de gerência do XenServer.  Antes de começar a falar sobre ele, muita gente (principalmente os #linuxUsers) tem a seguinte dúvida: Existe alguma ferramenta de gerência do XenServer que rode na web ou que rode em Linux, já que o XenCenter só funciona por padrão no Windows?  Resposta: Sim! Existem inúmeras ferramentas que fazem esse tipo de gerenciamento do Xen (assim como outros hypervisors [esxi, kvm. . ]) e que funcionam tanto na plataforma web como versão desktops.  Ex:  Web:  &#8211; XenOrcherstra;  &#8211; XAC;  &#8211; Archipel;  GNU/Linux / Windows:  OpenXenManager; OpenXenCenter; Libvirt; Explicando:  Porém, caro usuário, a bola da vez é o seguinte dilema: Como ter eficácia/eficiência junto com estabilidade? Se queres o primeiro, significa que você quer ter uma relação perfeita, além de harmoniosa, entre que tipo de cliente (Web/Desktop) você irá usar para acessar sua infra-estrutura de virtualização e as ações que você espera o mesmo retornar a partir de seus comandos. Nem sempre é padrão a estabilidade vir com a utilização de ferramentas recomendadas oficialmente (como por muitos anos o internet explorer, arg…), mas, neste caso o que o ocorre é que várias ferramentas de terceiros (muito boas) como Xen Orcherstra e Archipel, em fase de crescimento na comunidade open source, ainda não atingiram a maturidade suficiente para ATESTAR que podem realizar, com sucesso, todos os comandos para ações realizadas em um ambiente de produção.  No ano de 2014 vi a oportunidade de pesquisa nesta área (ainda) obscura, então, comecei a escrever minha monografia (especialização) sobre o tema, entitulada &#8220;Análise de ferramentas open-source de administração de ambientes heterogêneos de virtualização&#8221;. Defendi com sucesso a mesma em 2015.  Como resultados desta pesquisa, concluí que, a menos que você utilize estas ferramentas para medidas de montagem de ambientes futuros e testes, não é recomendado, em ambientes de alta criticidade. Imagine a seguinte situação: Acontece um congelamento da tela do programa (ou janela), por causa de um erro interno, no momento de uma operação de migração ou cópia de uma VM. Você não consegue mais visualizar os processos nem utilização dos recursos do XenServer e nem os logs e não sabe ver, rapidamente, se o processo travou, se o XAPI caiu ou se a VM está no ar ou se foi desligada.  Resultado: Os transtornos podem ser enormes. Fora a busca por problemas, em fóruns oficiais da ferramenta, que se torna limitada pelo fato de você já estar utilizando uma ferramenta para gerenciamento do XenServer que não a oficial.  Atenção: Não estou promovendo o uso do Windows nem desmotivando a colaboração para com a comunidade cada vez mais livre. No entanto, preste bem atenção no que você irá colocar em produção na infra-estrutura de seu trabalho (nas suas costas!). Teste bem e crie uma documentação sobre todos os testes que fizer com ela (listando o que está dando bugs e o que funciona &#8220;redondinho&#8221;).  Para saber como instalar o XenCenter, deixo aqui os procedimentos da documentação oficial:  http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-intro-welcome/xs-xc-intro-start. html  http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/installation. html#center_installation  Espero que tenham gostado da explicação e das vantagens/desvantagens de utilização de ferramentas não oficiais.  Abraços e até a próxima!  Referências:  http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-intro-welcome/xs-xc-intro-start. html  http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/installation. html#center_installation  http://xenserver. org/open-source-virtualization-download. html "
    }, {
    "id": 22,
    "url": "http://localhost:4000/tecnologia/2016/02/17/upgradeupdate-no-xenserver-6-5.html",
    "title": "Upgrade/Update no XenServer 6.5",
    "body": "2016/02/17 - Segue abaixo uma descrição resumida sobre a conceituação dos seguintes termos. Update: Atualização (hotfixes) de procedimentos críticos e não críticos de segurança, adição de drivers ou correção de bugs em pacotes → Trivial; Upgrade: Atualização de versão do sistema de virtualização XenServer, o que pode aglomerar melhorias nos drivers de dispositivos, adicionar funcionalidades, alterar versões de SO usado (neste caso, o GNU/Linux CentOS) e aumento na capacidade de processamento do próprio sistema operacional → (Geralmente crítica e menos trivial [lê-se: trabalhosa]); O que ocorre? Muito sysadmin deixa o seu ambiente funcional, perfeitinho e redondinho e enquanto ele estiver funcionando não meche nele porque “não se meche com quem tá queto”. Nos meus tempos usando XenServer e GNU/Linux aprendi uma coisa: Sempre tente deixar seus sistemas com as últimas versões de atualização. Updates são lançados para serem usados, eles contém novos drivers, patches de segurança, novas versões de softwares com bugs, otimização de código, enfim, não ache que porque seu sistema está no ar que ele não pode cair amanhã por um erro que você já devia tê-lo imunizado. Te garanto que é doloroso você ter que atualizar o seu ambiente com vários hotfixes na fila de espera, pois cada update vai gerar um mini ataque cardíaco em você. Para realizar procedimento de update até a versão 6. 2 do xenserver open source você teria que ir para a CLI (Linha de comando) e aplicar os passos mostrados neste tutorial: http://support. citrix. com/article/CTX132791 Curiosidade: Na época em que tínhamos que ir para a linha de comando na versão sem licença paga, vários usuários da comunidade elaboraram suas próprias soluções para realização de update do ambiente. E é disso que estou sempre falando: Compartilhamento de conhecimento!! Olhem os links: http://discussions. citrix. com/topic/310573-script-to-update-xenserver-with-powershell/ https://www. citrix. com/blogs/2014/09/10/scripting-automating-vm-operations-on-xenserver-using-powershell/ https://www. virtualexperience. no/2012/11/30/ctxupdate-a-powershell-script-to-download-any-citrix-updates/ Felizmente hoje, a partir da versão 6. 5 (versão atual até a última atualização deste tutorial), como o código do XenCenter foi liberado (assim como o código de quase todas as partes do XenServer), foi inevitável liberar a opção no GUI do próprio XenCenter para realizar operações de update. Isso te dá a possibilidade de deixar a cargo do XenCenter baixar as atualizações e automaticamente aplicar e reiniciar (quando for o caso) o host, sem que se precise fazer de forma manual (apesar de ele também disponibilizar a opção de reiniciar o servidor manualmente). Por padrão, o XenCenter já vem configurado para sempre checar se existem atualizações disponíveis para hosts xen nele conectados. Quando for tornada disponível a update, ela vai aparecer na aba de notificações do seu XenCenter, e clicando com o botão direito do mouse em cima dela você pode baixar ou obter informações sobre ela. Antes de atualizar, leia o máximo possível sobre a mesma afim de reconhecer os impactos esperados na pré e pós atualização do ambiente. Antes disso, realize backup de suas informações como metadados do pool, hosts, e VM. Saiba como realizar backup disso tudo neste aqui: Eu criei um desenho do fluxo processual que me baseio sempre na hora de realizar procedimentos de update em ambientes XenServer, o qual disponibilizo abaixo:     Nele, mostro que devemos sempre checar a criticidade e impactos institucionais e técnicos antes do procedimento de update, após isso será agendada a atualização (se tiver paradas no servidor, deverão ser previamente relatadas), realizar backups do pool, Vms e xen host (quando houver recurso para o último), desabilitar o HA (requisito técnico) e só depois iniciar a atualização. Alguns procedimentos minuciosos, bem como todo o passo a passo e pré requisitos de configuração necessários para a realização de um processo de update podem ser conferidos neste link da documentação oficial: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-updates/xs-xc-updates-applying. html Com relação à Upgrades (atualização de versão) no Xenserver, existe a possibilidade de realização do procedimento de maneira live, sem que as Vms parem, claro, se você tiver storage compartilhado. As Vms podem ser migradas de um Xenserver para outro com uma versão igual ou superior da de origem, por exemplo de um xenserver 6. 2 para um 6. 5. Isso é vantajoso neste tipo de atualização, onde a troca das versões é crucial. Procedimentos e detalhes técnicos de realização de upgrade em um pool (Rolling Pool Upgrade) você pode continuar a leitura do link que passei anteriormente, até chegar nessa parte: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-updates/xs-xc-upgrade. html E a mesma imagem para guiar você no processo de update (colocada acima) pode ser usada no processo de upgrade, claro, alterando os detalhes de ordem técnica (na fase de “install update”), mas, o fluxo geral é o mesmo. Espero que tenha ficado claro para vocês a importância e os procedimentos da documentação oficial que disponibilizei para você. Grande abraço. Referências: http://support. citrix. com/article/CTX132791 http://discussions. citrix. com/topic/310573-script-to-update-xenserver-with-powershell/ https://www. citrix. com/blogs/2014/09/10/scripting-automating-vm-operations-on-xenserver-using-powershell/ https://www. virtualexperience. no/2012/11/30/ctxupdate-a-powershell-script-to-download-any-citrix-updates/ http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-updates/xs-xc-updates-applying. html http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-updates/xs-xc-upgrade. html    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 23,
    "url": "http://localhost:4000/tecnologia/2016/02/17/troubleshooting-resolucao-de-problemas-xenserver-6-5.html",
    "title": "Troubleshooting – Resolução de problemas – XenServer 6.5",
    "body": "2016/02/17 - Hoje, o assunto é sobre troubleshooting, ou, para os menos familiarizados (adeptos do “se está funcionando, está bom” rs) sobre resolução de PROBLEMAS!! Até porque só tem problemas aqueles que fuçam na coisa! De acordo com a wikipedia: “Troubleshooting é uma forma de resolver problemas, muitas vezes aplicada na reparação de produtos ou processos falhados. É uma busca sistemática e lógica pela raiz de um problema, de modo a que possa ser resolvido e o produto ou processo possa ficar novamente operacional. ” Portanto, partindo do princípio da busca sistemática e lógica, utilizarei sempre diagramas sistêmicos e fluxogramas para descrever processos de troubleshooting. Mas, porque trabalhar com fluxogramas em troubleshooting? Bem, a literatura educacional já tem uma muita pesquisa sobre isso ([1], [2], [3], por exemplo), mas em resumo e tomando como questões também pessoais: Entendeu ou quer que eu desenhe? Sim, esta frase, muitas vezes tratada de professor para uma sala de aula ou de um amigo que é o “sabichãozão” para com os outros, é lembrada com um tom arrogante. O que quero é tirar este rótulo. No sentido literal, acredito que tudo deveria ser “desenhado”. A simples forma de uma desenho e a capacidade que ele tem de armazenar várias informações em uma única imagem torna a imersão no conhecimento mais divertida e muito menos enfadonha. Para mim, este é o verdadeiro papel do professor. Aquele que guia e consegue tornar trivial um conteúdo complexo. Ler slides e livros até o google voice faz. Você pode perceber que na maioria dos meus tutoriais eu encaixo um desenho que tenta generalizar um processo ou a arquitetura de um sistema que estou explicando. Sempre com uma única imagem. Acredito neste tipo de imersão educacional. Só não esqueçamos que as referências escritas, mesmo que muitas vezes chatas, tem de ser levadas em suma consideração. Desenhos são generalizações que quase sempre não são perfeitas. A ideia dele é fazer com que o leitor desperte um interesse ou que o processo de melhoria/releitura de um conteúdo ocorra de forma mais eficiente (em menos tempo). Bem, em processos de resolução de problemas não seria diferente. Na comunidade do xenserver temos muito pouca (ou nenhuma) documentação de troubleshooting através de fluxogramas. Claro que usuários do fórum oficial (Discussion Citrix) e comunidades (xen-br, gc-br, Telegram Xenserver) ajudam bastante, mas, é como se o conhecimento estivesse espalhado e disperso em fóruns e dúvidas de usuários. Não há algo conciso, neste caso. Bem, uma vez fui aplicar 5 hotfixes em um xenserver 6. 2 (desculpe, me atrasei). Seguindo a documentação oficial era como roubar doce de criança (mil maravilhas), mas, na prática não é bem esse carnaval não. É como você recompilar um kernel Linux achando que ele não vai dar pelo menos um bug. Inocência. Caí em várias armadilhas e situações adversas neste processo e sempre resolvia tentando encontrar soluções naquele momento. Resultado: Sanei os problemas, atualizei meu ambiente e o trabalhão que deu não foi documentado. POOFF na cara da comunidade (e na minha)! A partir daí, resolvi documentar, no estilo de fluxogramas, os processos de troubleshooting do xenserver em determinadas fases de manutenção. Atualmente, realizei a criação de um fluxograma do processo referente ao troubleshooting de erros na aplicação de updates no XenServer 6. 5. Disponibilizo este documento logo abaixo: Troubleshooting update – XenServer 6. 5: Para muitos que sofrem com bugs quando vão atualizar seu ambiente, creio que este processo irá ser de grande ajuda. Meu objetivo é fazer com que usuários contribuam com processos que podem ser melhorados/otimizados no fluxograma. Remodelando o documento através do perfil da comunidade, por meio de críticas e sugestões de usuários, poderemos compilar uma documentação ainda mais concisa do que disponibilizo aqui para você. Com o passar do tempo creio que este post vai crescer bastante, pois novos fluxogramas irão sendo disponibilizados por mim e pela comunidade. É o que quero. Um abraço! Até mais. Referências: https://pt. wikipedia. org/wiki/Troubleshooting https://discussions. citrix. com/ https://groups. google. com/forum/#!forum/xen-br https://groups. google. com/forum/#!forum/gc-br    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 24,
    "url": "http://localhost:4000/tecnologia/2016/02/17/storage-xenmotion-no-xenserver-6-5.html",
    "title": "Storage XenMotion no XenServer 6.5",
    "body": "2016/02/17 - Falei, anteriormente aqui sobre “XenMotion”. Hoje irei falar sobre “Storage XenMotion”. Storage XenMotion nos remete a ideia de “XenMotion entre storages”, e é exatamente isso que este recurso (fascinante) faz. A partir dele, a VM pode ser transferida entre storages distintos, ou seja, os discos da VM (VDIs) podem ser migrados entre pools diferentes (entre dois sites XenServer). Tudo isso com o mínimo de downtime possível, pois geralmente se perde alguns pings quando se é re-setado a placa de rede virtual e a rota é alterada. E não é propaganda Tekpix, o recurso existe e é disponível com código fonte liberado (aêêêêêê)!!! OBS: Convido você a ir no site da VMware e ver a bagatela que é a licença com o recurso equivalente (VMware Storage vMotion) habilitado. Muitos dos requisitos necessários para utilizar Storage XenMotion são do próprio XenMotion. A lista com todos é essa: – O XenServer tools deve estar instalado na VM; – O host xen destino têm de ter a mesma ou versão superior do XenServer do host de origem; – O host xen destino têm que ter memória suficiente para provisionar a VM, caso contrário a VM não completará o processo de migração (isso é meio lógico, rs); – O drive de DVD deve estar setado como empty (não deve ter nenhuma . iso anexada ou nenhum cd/dvd dentro do drive do host); – Se as CPUs dos hosts de origem e destino forem diferentes, então a CPU do servidor de destino deve suportar todos os recursos da do servidor de origem, o que, por consequência, é muito improvável que as CPUs sejam de fabricantes diferentes, ou seja, é muito recomendável você trabalhar mesmo com o mesmo fabricante de processador (por exemplo, Intel ou AMD). – Não é possível migrar VMs que tenham mais de um snapshot (leia aqui meu outro tutorial sobre snapshots e saiba o porquê disso); OBS: Se a VM conter um snapshot, planeje a alocação de seu espaço no storage do host destino. Caso não entenda, o link acima sobre snapshots explica tudo isso. – Não é possível migrar VMs que tenham mais que 6 VDIs anexados (como somente um VDI é transferido por vez, creio que 7 VDIs iria comprometer bastante a VM em caso de um possível falha na migração). Limitações do Storage XenMotion: – Não deve ser usado em ambientes com XenDesktop (Virtual Desktop Infrastructure); – VMs que usam PCI pass-thru não podem ser migradas; – A perfomance da VM irá ser reduzida no processo de migração, então, cuidado com o horário de rush; – Deve ser desabilitado qualquer HA ou WLB configurado no pool de origem ou destino; Storage XenMotion é bastante utilizado em casos de Upgrade de Xenserver Standalone (hosts xen sem pool). Para saber como migrar uma VM através do XenCenter, acesse esse tutorial (http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-manage/xs-xc-vms-relocate. html). Vídeo demonstração do Storage XenMotion: https://www. youtube. com/watch?v=YWGu3tT6Z18 Até breve! Abraço!   Referências: http://www. amazon. com. br/Mastering-Citrix-Xenserver-Martez-Reed/dp/178328739X http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-manage/xs-xc-vms-relocate. html https://msinhore. wordpress. com/2012/09/20/storage-xenmotion/ https://www. youtube. com/watch?v=YWGu3tT6Z18 https://www. citrix. com/content/dam/citrix/en_us/documents/products-solutions/storage-xenmotion-live-storage-migration-with-citrix-xenserver. pdf?accessmode=direct http://ports. marllus. com/2016/02/15/xenmotion-no-xenserver-6-5 http://store. vmware. com/store/vmware/en_US/pd/productID. 284281000?src=WWW_eBIZ_productpage_vSphere_EnterprisePlus_Buy_US https://en. wikipedia. org/wiki/Desktop_virtualization    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 25,
    "url": "http://localhost:4000/tecnologia/2016/02/17/snapshots-no-xenserver-6-5.html",
    "title": "Snapshots no XenServer 6.5",
    "body": "2016/02/17 - E aí, tranquilo? Mas o que são snapshots? São arquivinhos (vou chamá-los assim) que possuem informações a respeito de um ponto na vida de uma VM. Essa informação serve para o administrador XenServer, por exemplo, voltar para um momento em que ele fez uma alteração na VM, como em uma pós configuração de um serviço PHP ou antes de uma trágica atualização de sistema (kernel panic, huuuuuuu). Lembre do ponto de restauração presente no Windows. É praticamente a mesma lógica. Os snapshots ajudam bastante em tarefas como estas, como “voltar” uma VM no tempo (de volta para o futuro e mart macflein) além de ser uma mão-na-roda para a realização de backups completos dela. Para o caso de backups, eles são usados para complementar o processo de backup à quente (sem desligar a VM). Um dos métodos seria: Primeiro é tirado o snapshot da VM, depois a partir do snapshot é realizado uma cópia completa para um arquivo único de backup (. xva). Porém, Snapshot, como muita gente acha, não é backup, de fato. Snapshot é informação da VM em um momento, ou seja, esse arquivinho grava os metadados da VM (cpu, ram, network, etc. ) e o ponteiro que aponta para uma região do vDisk da VM naquele instante de tempo em que foi tirado o snapshot. Esse arquivo é realmente pequenininho. Se você excluir sem querer um vDisk de uma VM e tentar recuperá-lo por meio de um snapshot, sinto muito meu amigo, ele não vai voltar no tempo trazendo o disco de volta, pois neste caso o próprio disco foi excluído. Como falei: Snapshot não é backup. Ele pode complementar um. Então, você deve estar pensando, como esse arquivinho é pequeno, vou tirar vários snaphots a cada 2 segundos para ter todos os instantes de tempo da minha VM e voltar na hora que eu precisar!! ahahah Maninho, não faça isso. O motivo? Quando você tira um snapshot, outro disco (VDI – Virtual Disk Image) é criado na sequência, gerando uma espécie de árvore (com pai, filho, neto…), e caso o seu SR (Storage Repository) seja baseado em volume (LVM) esse novo disco ocupará um espaço bem relevante! Para melhor explicar, desenhei o que acontece no SR (espaço consumido) em um ambiente XenServer quando se cria um snapshot de uma VM, quando o SR é iSCSI/FC ou Local LVM (onde os VDIs guardados estão em uma estrutura LVM) e quando é NFS ou Local EXT (onde os VDIs são guardados como arquivos VHD sem LVM). Para SR’s baseado em volume (iSCSI/FC, Local LVM): Para SR’s baseado em arquivo (NFS, Local EXT):   Destas representações gráficas, podemos deduzir, de forma clara, que: – Você deve se preocupar com o espaço alocado ao criar um snapshot quando estiver utilizando SR’s baseados em volume (Local LVM, iSCSI/FC). Fique sempre ligado na seguinte fórmula do custo para se criar um snapshot: Custo (espaço gerado no SR após snapshot) = Dados escritos no disco atual + Tamanho do disco; Informações a respeito de criação, gerenciamento, exclusão, importação e exportação de snapshots você pode conferir nestes links: (Xencenter GUI) http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-snapshots/xs-xc-vms-snapshots-take. html (Linha de comando) http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#id555786 Bem, de forma rápida expliquei qual o impacto da criação de snapshots em determinados tipos SR’s. Com essa informação, você já vai ter uma boa noção técnica para trabalhar com esses “arquivinhos”. Porém, o assunto não acaba por aqui. Se você quiser aprender mais sobre eles, como o que acontece quando snapshots são excluídos (coalescing) e o espaço gerado por esta operação, o limite de criação de snapshots e o porquê disso, além de outras informações “ninjas” (como o porque de não ser possível excluir um snapshot por falta de espaço no xen host) você pode conferir nos links da referência (principalmente aqui e aqui). Até mais e grande abraço!   Referências: http://avpaul. blogspot. com. br/2012/05/xenserver-losing-space-on-sr-and. html https://techblog. jeppson. org/2015/02/reclaim-lost-space-xenserver-6-5/ https://community. spiceworks. com/topic/319881-citrix-xenserver-6-0-2-out-of-disk-space http://pt. slideshare. net/davidmcg/top-troubleshooting-tips-and-techniques-for-citrix-xenserver-deployments http://discussions. citrix. com/topic/355832-how-to-reclaim-disk-space-from-deleted-snapshots-on-xenserver-62/ https://support. citrix. com/servlet/KbServlet/download/21626-102-714437/XenServer_Understanding_Snapshots. pdf http://xapi-project. github. io/features/snapshots/snapshots. html http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#id555786 http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-snapshots/xs-xc-vms-snapshots-take. html    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 26,
    "url": "http://localhost:4000/tecnologia/2016/02/17/resizing-vdisks-vdis-xenserver-6-5.html",
    "title": "Resizing vDisks (VDIs) – XenServer 6.5",
    "body": "2016/02/17 - Olá, tudo bem? Bem, o tema discutido de hoje será redimensionamento de disco virtual no XenServer. Muitas vezes, por falta de planejamento ou fatos inesperados, o tamanho do disco de uma VM precisa ser aumentado. Por conta deste problema, alguns administradores, com a visão estática de sistemas não virtualizados, não conseguem compreender com clareza como redimensionar um disco virtual. Se você prestar atenção, o XenServer deixa você alterar o tamanho de um disco de uma VM. Para isso, é só ir na aba configurações do storage da VM e alterar o valor do tamanho dele. Mas, calma que o tamanho da partição la ná VM não vai alterar automaticamente! rs. (assim você quer demais). Primeiro vamos entender o que é um disco de uma VM. A partir das imagens abaixo, explicarei sucintamente. O conjunto do relacionamento de objetos de storage do XenServer: Desenhado pela Citrix: Desenhado por Gohar Ahmed:   Desenhado por Martez Reed:   As três imagens demonstram os mesmos relacionamentos, só que com representações diferentes (para uma melhor didática). Todo dispositivo relacionado com armazenamento (um disco rídigo, por exemplo) que é conectado ao XenServer será reconhecido como um PBD (dispositivo de bloco físico). Então, quando você cria um SR (repositório de storage – storage repository) dentro do XenServer, está justamente configurando este(s) PBD(s) para ser(em) o armazenamento deste SR. Dentro deste SR eu posso ter vários VDI (imagem de disco virtual – virtual disk image), que é um objeto criado pelo XenServer que fornece uma abstração de um HDD (Disco Físico) e contém informações sobre a mídia física no qual se encontra (tipo de SR, se é compartilhável, se a mídia física é somente leitura, etc. ). O VBD (Dispositivo de Bloco Virtual), por sua vez, é uma abstração necessária para fazer a ponte entre a VM e o VDI. Ele representa o conteúdo do VDI. Caso não existisse o VBD, a VM não conseguiria utilizar o espaço que o VDI oferece dentro do SR. O VBD dá a possibilidade de a VM enxergá-lo como um dispositivo de bloco (neste caso um disco rígido) que pode ser formatado em um tipo de sistemas de arquivos. Por fim, o VBD contém atributos que ligam o VDI a VM, como QoS, atributos de leitura/escrita, se o disco é bootável, etc. Ainda não entendeu? Deixa eu explicar melhor: Imagine um PC físico com um disco rígido e você instalando um debian 8 nele. Blz né? Pois bem, analogicamente, temos uma VM sendo criada no XenServer com um disco virtual. Esse disco virtual é o nosso VBD. Por trás dele teremos o VDI correspondente, que por sua vez está dentro de um SR e este SR é composto por um ou vários PBDs. Agora, continuando o objetivo do tutorial, segue a pergunta: Como faço pra aumentar o tamanho de um disco de uma VM? Bem, como sabemos agora, um disco de uma VM é um VBD, que por sua vez tem um correspondente VDI. Até agora beleza! Os procedimentos genéricos padrão para aumentar (expandir) um vDisk são: 1- Ir no xencenter, configurações do storage da VM e aumentar o tamanho do disco especificado (neste ponto, você aumentou o tamanho do VDI); 2 – A partir deste ponto, o VBD irá ter um espaço adicional (não alocado) dentro dele, referente a esse aumento do VDI. Com qualquer “fdisk -l” ou “parted” você poderá ver esse espaço adicional; 3 – Agora, você terá que fazer a expansão em nível de SO (sistema de arquivo) na VM, para fazer com que a partição que você quer aumentar (ou adicionar) tenha um novo tamanho, utilizando para isso do espaço que foi inserido. 4 – Após os comandos de expansão, que podem variar se o disco tiver uma estrutura LVM (mais simples) ou sem LVM (um pouco mais de trabalho), você deve realizar um comando, em nível de SO, que vai redimensionar a partição para utilizar a nova quantidade de blocos. Geralmente em GNU/Linux o comando final é o “resize2fs /dev/particao”; OBS1:Caso a estrutura de partições esteja organizada na forma de LVM, você poderá expandir um disco também criando um novo disco para a VM (com o espaço que quer utilizar). Quando a VM reconhecer esse novo VBD, você o formata e o transforma em PV (Volume físico – estrutura LVM) e junta o mesmo ao PV existente na VM. O LVM trás a grande vantagem (além de simular um RAID 0) de tornar mais fácil e dar novas possibilidades à manipulação dos LVs (Volumes lógicos – pontos de montagem do SO – /home, /usr, etc. . ) e o redimensionamento do tamanho deles. Bem, partindo destes passos listo abaixo uma série de tutoriais que poderão ser seguidos por você para redimensionar vDisks de Vms. Aumentando o espaço de um vDisk com uma partição nativa Linux (sem LVM): https://www. rootusers. com/use-gparted-to-increase-disk-size-of-a-linux-native-partition/ Aumentando o espaço de um vDisk com uma estrutura LVM através da expansão do VDI: https://www. rootusers. com/how-to-increase-the-size-of-a-linux-lvm-by-expanding-the-virtual-machine-disk/ Aumentando o espaço de um vDisk com uma estrutura LVM através da adição de um outro VDI (como exemplificado no OBS1): https://www. rootusers. com/how-to-increase-the-size-of-a-linux-lvm-by-adding-a-new-disk/ Para expandir o tamanho de vDisks com SO MS Windows: http://support. citrix. com/article/CTX117630 Outros tutoriais e formas de expansão de vDisk: https://maanasroyy. wordpress. com/2012/06/03/resize-a-linux-vm-lvm-disk-in-xenserver/ https://codesilence. wordpress. com/2013/03/14/live-resizing-of-an-ext4-filesytem-on-linux/ OBS2 : Ainda não é possível diminuir (shrink) o tamanho de um VDI dentro do Xenserver. O motivo eu creio que deva ser porque na redução de um VDI, a probabilidade de afetar uma área com dados do sistema do usuário seria bem alta. Mesmo com LVM, um algoritmo que analisasse as áreas não alocadas para serem liberadas do disco, além de muito minucioso, poderia vir a corromper o sistema em uma exclusão errada, além do que o usuário teria que desalocar aquela região que seria liberada. Considero um problema tanto trabalhoso para resolver, mas não impossível. Há um meio de realizar esse processo (não muito “ortodoxo” – pra não dizer gambiarra). Os passos são listados abaixo: – Anexar um novo VDI na VM em questão e criar uma partição em toda sua extensão (o tamanho do VDI deve ser de pelo menos do tamanho dos dados do disco); – Utilizar algum programa de clone de disco e dar o boot via ISO (exceto o clonezilla, pois ele tem uma limitação que jájá explicarei); ex: HD clone, fsarchiver, FOG project, etc. – Clonar o disco da VM jogando a imagem no VDI anexado na mesma; – Criar uma nova VM no Xenserver com um disco menor do tamanho que você quer diminuir; – Iniciar o programa de clonagem e anexar na VM o VDI que contém a imagem exportada e restaurar a imagem do disco antigo para o novo disco; OBS3: O clonezilla têm a limitação que na restauração de um disco, o tamanho do disco de origem têm de ser maior ou igual ao do disco de destino, o que é é inviável na hora de um shrink. OBS4: Alguns usuários na internet disseram que conseguiram shrink de discos como Clonezilla (mas somente quando o disco de destino era um pouco menor de tamanho que a origem). Você pode conferir os relatos aqui. Perceba que vários tutorias utilizam o hypervisor Vmware, mas, não se preocupe. O entendimento que você tem que ter é de como funcionam as relações de PBDs, VDIs e VBDs com Vms. O processo de criação de disco ou aumento do tamanho usando Xenserver (Xencenter) ou Vmware (vCenter) é só interface. Os passos genéricos padrão (citados acima) são os mesmos para qualquer hypervisor. Espero que tenha gostado! Grande abraço.   Referências: https://www. schirmacher. de/display/INFO/How+to+increase+XenServer+virtual+machine+root+or+swap+ partition https://thewiringcloset. wordpress. com/2013/01/09/extending-a-root-filesystem-in-linux-without-lvm/ http://kb. vmware. com/selfservice/microsites/search. do?language=en_US&amp;cmd=displayKC&amp;externalId=1007907 http://discussions. citrix. com/topic/237812-extend-vm-disk-size-debian-guest/ https://www. rootusers. com/use-gparted-to-increase-disk-size-of-a-linux-native-partition/ https://www. rootusers. com/how-to-increase-the-size-of-a-linux-lvm-by-expanding-the-virtual-machine-disk/ https://www. rootusers. com/how-to-increase-the-size-of-a-linux-lvm-by-adding-a-new-disk/ https://www. rootusers. com/lvm-resize-how-to-decrease-an-lvm-partition/ http://support. citrix. com/article/CTX117630 https://maanasroyy. wordpress. com/2012/06/03/resize-a-linux-vm-lvm-disk-in-xenserver/ https://codesilence. wordpress. com/2013/03/14/live-resizing-of-an-ext4-filesytem-on-linux/ http://cleriston. com. br/post/110578666928/identificando-vdi-no-xenserver-via-command-line https://discussions. citrix. com/topic/361767-convert-vm-from-hyper-v-2012-to-xenserver-62/ https://www. miray. de/products/sat. hdclone. html http://www. fsarchiver. org/Fsarchiver_vs_partimage https://fogproject. org/ http://clonezilla. org/ https://community. spiceworks. com/topic/225979-clonezilla-restore-to-smaller-hard-drive http://clonezilla. org/clonezilla-live/doc/02_Restore_disk_image/advanced/09-advanced-param. php http://docs. vmd. citrix. com/XenServer/5. 5. 0/1. 0/en_gb/images/sr-diagram. png http://www. amazon. com/Implementing-Citrix-XenServer-Quickstarter-Gohar/dp/1849689822 http://www. amazon. com. br/Mastering-Citrix-Xenserver-Martez-Reed/dp/178328739X    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 27,
    "url": "http://localhost:4000/tecnologia/2016/02/17/rede-no-xenserver.html",
    "title": "Rede no XenServer",
    "body": "2016/02/17 - Olá! Hoje estarei te guiando a criar e configurar redes virtuais no XenServer 6. 5. Mas, primeiro iniciarei conceituando os termos: NIC: Adaptador de Rede (Network Interface Card). A NIC é a placa de rede física, propriamente dita, instalada no host XenServer. PIF: Interface Física de rede (Physical Network Interface). Este termo refere-se a um objeto criado pelo XenServer para representar uma NIC física. VIF: Interface de Rede Virtual (Virtual Network Interface). É um termo para batizar redes virtuais criadas dentro do XenServer. As VIFs são sempre associadas com NICs existentes no host XenServer. Por exemplo, você pode criar 3 VIFs associadas a uma mesma NIC e neste caso, todo tráfego destas interfaces virtuais sairão/entrarão pela mesma NIC. Network: É um virtual switch ethernet. Esse tipo de objeto tem uma coleção de VIFs e PIFs conectada a ele. Cada host XenServer tem uma ou mais networks. Networks que não têm associação com PIFs são consideradas “internal” (o gateway é o próprio hypervisor) e são geralmente usadas para prover conectividade entre VMs em um mesmo host XenServer. VLAN: Definidas pelo padrão IEEE 802. 1Q, as Redes Locais Virtuais, habilitam uma simples rede física para suportar múltiplas redes lógicas. VLANs operam na camada 2 do modelo OSI e são bem usadas para segregar redes distintas utilizando o mesmo canal físico para transmissão. BOND: Junção de duas ou mais NICs afim de realizar agregação/failover de links. Os modos disponíveis de BOND são: active-active: como o nome diz, é realizada o aumento da “largura de banda” (lê-se: Taxa de transmissão) da rede da VM. Porém, vale lembrar que se um tráfego é enviado pela VM, através de uma NIC (do bond), somente um caminho vai ser eleito para este tráfego em específico. O algoritmo de análise de tráfego de rede do ambiente faz um teste, a cada 10 segundos, de quanto a VM está enviando/enviou pela rede. Resumindo, os tráfegos das VMs que estão com o bond conectados a elas são espalhados entre as NICs agrupadas do bond, mas, um único tráfego de uma VM não pode ser espalhado em várias NICs. Diferentemente ocorre com o storage multipathing (tipo de balanceamento de links entre host xen e storage), onde um tráfego pode ser dividido entre dois ou mais caminhos para o storage (em nível de bloco) (mais informações [aqui]). active-passive: Uma NIC do bond falha, a outra assume. LACP baseado em IP e porta: Funciona da mesma forma do bondig active-active, só que o algoritmo desse tipo de bond vai eleger o caminho para um tráfego baseado no ip e porta de origem, ou seja, várias aplicações podem usar caminhos diferentes nas NICs reais do bond. Isso é legal se você quer distribuir o tráfegos de várias aplicações que usam portas distintas na rede de uma VM entre NICs do bond. LACP baseado em MAC address: A mesma coisa do anterior, porém, baseado no endereço MAC da VIF da VM, ou seja, o roteamento é selecionado em função da VM. Esse balanceamento é legal quando se vai utilizar várias VMs dentro de um mesmo host sem muitas aplicações funcionando em portas distintas. A escolha desses modos irá se basear no tipo de aplicação que funcionará no ambiente, que tipo de arquitetura de rede foi planejada (quantidade de NICs, throughput, topologia, etc), que tipo de storage vai ser conectado, enfim, há uma série de pontos a serem levados em consideração para se dizer “esse é melhor do que aquele”. OBS: XenServer 6. 5 SP1 suporta o limite de 16 NICs por host xenserver e cada VM suporta até 7 VIFs associadas. Desenhando: Para criação e gerenciamento de BONDs e outros tipos de objetos no xenserver, siga o manual oficial: http://docs. citrix. com/en-us/xencenter/6-2/xs-xc-hosts-manage/xs-xc-hosts-network/xs-xc-hosts-nics. html Praticando: OBS: MTU significa Unidade Máxima de Transmissão e isso é um fator crucial (se bem configurado – Jumbo Frames) para uma maior eficiência na transmissão de dados para a VM, porém, existem certas limitações no Xenserver. Estas e outras informações mais detalhadas, você pode consultar no tópico “4. 3. 4. Jumbo frames” do “Citrix XenServer 6. 5 SP1 Administrator’s Guide“. Caso não saiba sobre MTU e nem o que colocar como valor no campo quando estiver criando um BOND ou VLAN, deixe o padrão 1500 e siga em frente. Espero que tenha sido claro neste tutorial! Qualquer dúvida só perguntar nos comentários! Abraço.   Referências: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html http://support. citrix. com/article/CTX135690#LACP bonds http://docs. citrix. com/content/dam/docs/en-us/xenserver/xenserver-61/xs-design-iSCSI-multipathing-config. pdf http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#lacp-bond http://docs. citrix. com/en-us/xencenter/6-2/xs-xc-hosts-manage/xs-xc-hosts-network/xs-xc-hosts-nics. html  Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 28,
    "url": "http://localhost:4000/tecnologia/2016/02/17/pv-hvm-hvm-com-drivers-pv-pvhvm-pvh-no-xenserver-a-sopa-de-letrinhas-da-virtualizacao.html",
    "title": "PV, HVM, HVM com Drivers PV, PVHVM, PVH no XenServer (A sopa de letrinhas da virtualização)",
    "body": "2016/02/17 - Olá. Hoje falarei sobre os termos PV, HVM e seus derivados. Sinceramente, esse assunto é meio tenso, pois, na internet vejo muita confusão sobre isso. Modos, grupos, grupos de modos, melhorias, tipos de virtualização, emulação… é uma sopa de letras e que no final só machuca a cabeça de quem tenta entender. Por isso, vou tentar (espero), da melhor forma possível, explicar pra você qual a diferença entre estes modos, suas melhorias e as vantagens e desvantagens de usar um ou outro, parafraseando o xenwiki, sem que você sofra um aneurisma! rs Na verdade, tudo surgiu com o modo ‘Totalmente Virtualizado (Fully Virtualized – FV) na IBM em 1960′. Mas só era eficiente usá-lo nos mainframes da IBM, pois o mesmo era muito lento em arquiteturas x86. Já em 2003, com o lançamento do projeto Xen 1. 0, foi criado o modo: PV (Paravirtualization ou OS Assisted Virtualization): Quando uma VM é executada neste modo, o seu kernel foi modificado na tentativa de proporcionar maior desempenho com utilização de hypercalls. Hyper. . o quê? “Simples”, por meio deste kernel modificado a VM “sabe” que está sendo virtualizada. Isto quer dizer que VMs podem realizar chamadas diretamente para o hypervisor (essa característica é conhecida como hypercalls) e isso torna o acesso ao hardware muito mais eficiente. OBS: Essas modificações no kernel, descritas acima, geralmente são referentes ao kernel Linux. O Windows hoje não tem kernels paravirtualizados (até tentaram, em vão). Porém, o tempo foi passando e surgiram tecnologias de hardware na tentativa de melhorar e tornar possível a “Full Virtualization – FV” na arquitetura x86. Foi pelo advento destas tecnologias que o projeto Xen, em 2005, lançou o suporte à HVM Guests, que conhecemos como o modo: HVM (Hardware Virtual Machine – também chamado de ‘Hardware Assisted Virtualization’ e ‘Hardware Extensions to Full Virtualization’): Neste modo, o hypervisor Xen usa o software “Qemu” para emular (via software – grande desvantagem) várias partes do host físico. Mas foi a partir das extensões HVM (criadas pela Intel e AMD e que fazem uma espécie de emulação de hardware) que foi possível “habilitar” esse modo na arquitetura x86. Essas extensões turbinam o acesso da VM à CPU do host físico, justamente onde o modo FV era mais fraco. Hoje, praticamente qualquer processador de médio porte já conta com este tipo de tecnologia (Intel VTx e AMD SVM). Muito se vê os termos HVM e Full Virtualization como sendo iguais ou que um é a evolução do outro, mas, podemos dizer que as extensões HVM foram um meio para que fosse possível a utilização do FV na arquitetura x86. Como praticamente toda a literatura se refere a HVM como um modo, também seguiremos a prática. Só não se engane nos conceitos. Pois bem, a partir daqui é possível perceber que existem vantagens e desvantagens na utilização do modo PV bem como também no modo HVM. Partindo desse princípio, por que não tentar juntar o melhor dos dois mundos e gerar outras formas de virtualização? Foi o que fizeram várias pessoas interessadas nisso. E ao longo dos anos, começaram a surgir melhorias, que tentavam utilizar a vantangem dos dois mundos, ou seja, a paravirtualização do modo PV com a extensão de virtualização que pode ser usada no modo HVM. Dentre essas melhorias (vou chamá-las de derivados híbridos), podemos citar: HVM com drivers PV: Modo HVM com os drivers de disco e rede paravirtualizados. Um exemplo disso, basicamente, é uma VM Windows com o XenServer tools (xentools) instalado. Este XenServer tools é um pacote de software que contém os drivers de disco e rede paravirtualizados para a VM Windows. OBS: No caso de VM Linux, esses drivers já vêm embutidos na instalação. PVHVM: Modo HVM com a paravirtualização dos drivers de disco e rede (xentools), controladores de interrupção e temporizadores. Um exemplo disso são as novas versões dos sistema operacionais suportados pelo XenServer 6. 5 (RHEL 7, CentOS 7, Oracle Linux 7, Ubuntu 14. 04). De acordo com a Citrix, todas as novas VMs instanciadas a partir destas versões serão criadas em modo HVM, pois estes sistemas operacionais suportam, nativamente, alternação da execução entre HVM e PV em determinadas tarefas. OBS: Segundo Olivier, a versão padrão do Debian 7 (Wheezy) também é compilado com estes drivers, ou seja, se você instalá-lo como “Other media install” no XenServer 6. 5, terá uma VM PVHVM. PVH: Modo PV com a extensão de hardware em instruções privilegiadas e tabelas de páginas (ui ui ui, desculpa aê). Esse modo com certeza é o maior refinamento do modo PV (com a junção das sempres legais extensões HVM) e talvez seja o que ficará e se perpetuará por bastante tempo em ambientes de virtualização com Hypervisor Xen. Mas, ainda não está disponível para ser testado no XenServer 6. 5, só na versão do xen source 4. 4 (e ainda engatinhando). A imagem abaixo representa, no lado esquerdo, os modos existentes e suas respectivas melhorias (filhos híbridos) e no lado direito um comparativo do que cada modo e melhoria tem em comum ou que difere do outro, se tornando mais performático ou pior. OBS: Como citado anteriormente, perceba que o Windows suporta somente os dois primeiros modos/derivados, “HVM” e “HVM com drivers PV”. Mas, por quê? Porque, para suportar a partir da melhoria “PVHVM” seria preciso a paravirtualização do APIC (Controlador Avançado de Interrupção Programável), consequentemente, seria necessário que o kernel do windows fosse recompilado com essa nova característica (reclame para a microsoft, rs). Clique na imagem para aumentar o tamanho.  A partir destes modos e suas melhorias, pode-se formular algumas perguntas: Qual o melhor modo, PV ou HVM? Depende. Em arquiteturas x86 o mais rápido é PV, já em x86_64, é o HVM. Isso se deve a mudanças realizadas em x86_64 pela AMD que acabaram deixando um pouco mais lenta a paravirtualização nessa arquitetura. Porém, pela preocupação com a memória extra despendida no “qemu” para a emulação da placa mãe e dispositivos PCI, muitos usuários preferem utilizar PV em VMs 64bits, mesmo que mais lento. Inclusive, a Citrix recomenda a utilização de PV (quando não há a possibilidade de PVHVM). Como escolher o modo ou melhoria para utilizar no meu ambiente XenServer 6. 5? Deixo aqui um fluxograma para lhe ajudar na escolha dos modos/derivados híbridos para uma máquina virtual x86_64, que, segundo recomendado pelo próprio xen project, irá servir para a maioria dos casos: Exceto as distros RHEL 7, CentOS 7, Oracle Linux 7, Ubuntu 14. 04 e Debian 7 (que suportam PVHVM), e analisando o fluxograma acima, você poderá cair no modo HVM com Drivers PV, certo? Pois bem, eu, particularmente, utilizo o modo PV, mesmo em VMs (Guests) 64 bits. Apesar da rapidez adicional que eu poderia ganhar utilizando HVM, alguns fatores me levaram a adotar o PV: Recomendação da Citrix na utilização dos templates dela (PV), e vulnerabilidades importantes de segurança que afetavam somente VMs em HVM (como relatadas aqui, aqui e aqui). Isso me fez repensar a importância do uso do PV até que se tivesse um modo ou melhoria que fosse MUITO vantajoso em termos de eficiência. É o caso do aparecimento do PVHVM. A própria Citrix fala isso na documentação oficial e diz que vai começar a trabalhar com ele nos Guests que citei no início do parágrafo, apesar de não falar o nome PVHVM (creio que para não gerar um aneurisma no usuário, rs). De forma rápida e direta (para a maioria dos casos): Se VM GNU/Linux e BSD: Use PVHVM, nos sistemas operacionais suportados. Caso contário, use PV. Se VM Windows: Use HVM com drivers PV, nos sistemas operacionais suportados. Se não, use HVM. E o modo PVH, que é melhor? Estou aguardando poder testá-lo no XenServer. Mas, até agora só por gambiarras e ainda não é oficial, apesar de ele ter sido liberado na versão do xen 4. 4, que o XenServer 6. 5 incorpora. Vamos ter que esperar um tempo até que comece a ser implementado de forma estável nas distros. Bem, espero que tenha gostado do tutorial e da história de como surgiram os modos e suas melhorias e que saiba agora os benefícios e malefícios de cada um. O que não lhe impede de realizar testes para a comprovação destes dados (e contribuir para este tutorial). Para mais informações, consulte as referências (espetaculares e que me ajudaram muito para a elaboração desse texto).   Referências http://hostel. ufabc. edu. br/~marcelo. nascimento/BC1518Q3/arquivos/virtualizacao_cap4-v2. pdf https://xen-orchestra. com/blog/debian-pvhvm-vs-pv/ http://wiki. xenproject. org/wiki/Understanding_the_Virtualization_Spectrum https://blog. xenproject. org/2012/10/23/the-paravirtualization-spectrum-part-1-the-ends-of-the-spectrum/ https://blog. xenproject. org/2012/10/31/the-paravirtualization-spectrum-part-2-from-poles-to-a-spectrum/ http://xenserver. org/blog/entry/creedence-debian-7-x-and-pvhvm-testing. html http://xenproject. org/downloads/windows-pv-drivers. html https://wiki. xenproject. org/images/c/c2/Xen-mode-flow. png http://www. gossamer-threads. com/lists/xen/devel/363836 http://www. brendangregg. com/blog/2014-05-07/what-color-is-your-xen. html http://www. gta. ufrj. br/grad/09_1/versao-final/virtualizacao/xen. html http://ovmnaveia. blogspot. com. br/2012/09/pvm-paravirtualizado-ou-hvm. html http://www. informit. com/articles/article. aspx?p=2233978 https://pt. wikipedia. org/wiki/Advanced_Programmable_Interrupt_Controller http://www. vmware. com/files/pdf/VMware_paravirtualization. pdf https://en. wikipedia. org/wiki/IBM_CP-40 https://sourceforge. net/p/xen/mailman/message/5533663/ http://lwn. net/Articles/109789/ https://en. wikipedia. org/wiki/Full_virtualization https://www-950. ibm. com/events/wwe/grp/grp019. nsf/vLookupPDFs/7%20-%20VM-45-JahreHistory-EA-J-Elliott%20%5BKompatibilit%C3%A4tsmodus%5D/$file/7%20-%20VM-45-JahreHistory-EA-J-Elliott%20%5BKompatibilit%C3%A4tsmodus%5D. pdf http://lwn. net/Articles/52033/ https://sourceforge. net/p/xen/news/2003/10/xen-10-stable-released/ https://www. qnap. com/i/en/qa/con_show. php?op=showone&amp;cid=258 http://wiki. xenproject. org/wiki/Linux_PVH http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#id533926 http://pt. slideshare. net/xen_com_mgr/performance-tuning-xen-18477250 https://xen-orchestra. com/blog/debian-pvhvm-vs-pv/ http://www. brendangregg. com/blog/2014-05-09/xen-feature-detection. html http://wiki. xen. org/old-wiki/xenwiki/XenLinuxPVonHVMdrivers. html    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 29,
    "url": "http://localhost:4000/tecnologia/2016/02/17/pools-no-xenserver-6-5.html",
    "title": "Pools no XenServer 6.5",
    "body": "2016/02/17 - Olá, Agora explicarei sobre pool de recursos, bem como citar sua definição e requisitos para ser implantando. Um pool de recursos é um termo usado para designar um grupo de instalações XenServer (hosts xen). Esse grupo pode ser um laboratório de hosts xen de teste, produção ou qualquer outro conjunto de servidores em operação para um determinado fim. Em todo e qualquer pool existirá o membro master (host que roteia a comunicação para outros membros do pool quando necessário) e os restantes slaves. Cada membro têm consigo um base de dados que contém informações a respeito de todos os membros existentes no pool, ou seja, qualquer host no pool sabe quem é master e quem é slave e quem está no pool. Quando neste pool existe um storage compartilhado, que é um local onde todos os hosts xen têm acesso para leitura/escrita de dados, VMs podem ser migradas, (quase) sem dowtime, entre estes hosts. Essa migração é o recurso no XenServer chamado XenMotion. Se a característica de Alta Disponibilidade (HA) estiver habilitada no pool e um host xen falhar/desligar/se perder/bugar, qualquer VM (definida por você) será movida automaticamente para outro host xen vivo, bem como um novo host membro master será eleito, se este host perdido for o membro master do pool. O limite máximo é de 16 hosts xen em um mesmo pool. Existem dois tipos de pools, os homogêneos e os heterogêneos. Em um pool homogêneo, as seguintes características são necessárias: – As CPU’s de todos os hosts xen no pool devem ser as mesmas (em modelo, marca e características); – Todos os hosts xen devem ter a mesma versão de software XenServer, bem como os mesmos hotfixes (updates) aplicados; Já em um pool heterogêneo: – As CPU’s de todos os hosts xen precisam ter somente os mesmos fabricantes (ex. AMD, Intel). – As CPU’s de todos os hosts xen devem ter suporte à tecnologia Intel FlexMigration (em caso de CPU’s Intel) ou AMD Enhanced Migration (em caso de CPU’s AMD); – Todos os hosts xen devem ter a mesma versão de software XenServer, bem como os mesmos hotfixes aplicados; Você deve estar se perguntando qual tipo de pool utilizar, se homogêneo ou heterogêneo. O recomendável é usar CPU’s com o máximo de equivalência possível, assim, a compatibilidade é melhor aproveitada entre elas, possibilitando transtornos mínimos em processo migratórios que possam vir a calhar no ambiente. Isso reforça a ideia de hoje ainda não ser trivial uma total compatibilidade entre CPU’s distintas. Estas tecnologias supracitadas, como FlexMigration (Intel), nada mais são que “gambiarras tecnológicas” criadas afim de resolverem parte destes problemas.  No futuro, eu espero que a informação em tornos das CPU’s seja totalmente abstrata (de forma nativa) para o sistema operacional, consequentemente para a compilação de aplicações e VM’s em ambientes virtualizados. Sem dúvida isso facilitará, e muito, o processo de realocação de serviços neste tipo de infra-estrutura, tão volátil que é. Abaixo eu listo uma série de requisitos necessários (e obrigatórios) ao host xen para se criar um pool homogêneo. – Ele não deve ser membro de um pool já existente; – Ele não deve ter nenhum storage compartilhado configurado; – Caso o pool já tenha sido criado e você queira adicionar um host ao mesmo, este host não deve ter nenhuma VM rodando ou em estado de suspensão ou nenhuma operação ativa em progresso na VM, como um desligamento, por exemplo; Outros requisitos bem importantes, que também devem ser seguidos: – Cheque se o serviço de tempo está sincronizado entre todos os hosts (use algum servidor NTP confiável, se possível); – Não configure bond na interface de rede de gerência (se for fazer isso, faça após a criação do pool); – Certifique-se que o ip de gerência do pool é estático (configurado manualmente ou “amarrando” por DHCP); Passos para se criar um pool: Abra o XenCenter e siga os passos abaixo:    Abra a caixa de diálogo “New Pool” e depois clique na toolbar “New Pool”.     Coloque um nome para o novo pool e uma descrição opcional e selecione o servidor que será o pool master. Adicione também o restante dos servidores que comporão o pool, através da lista de membros adicionais que aparecerá ou adicionando um novo membro através do botão “Add New Server”.     Clique em “Create Pool” para criar o pool e feche a caixa de diálogo     Pronto, pool criado!  Para adicionar um host a um pool já criado:    Clique com o botão direito em cima do pool e vá opção “Add Server”.     Na janela que abrirá, digite o ip do servidor e as credenciais do mesmo e clique em “Add”.     Pronto, servidor adicionado!  Informação adicional: A Citrix recomenda que você tenha um storage compartilhado em mãos antes de criar um pool, pois este é um pré-requisito para você poder utilizar a maioria dos recursos (além de outros) que citei no início do artigo. Referências: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-pools/xs-xc-pools-about. html http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#hosts_and_pools  Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 30,
    "url": "http://localhost:4000/tecnologia/2016/02/17/p2v-v2v-conversao-de-ambientes-xenserver-6-5.html",
    "title": "P2V / V2V – Conversão de ambientes – XenServer 6.5",
    "body": "2016/02/17 - Bem, P2V e V2V são termos que remetem à migração de sistemas. E migração (desde antes de cristo – 40 anos de migração dos hebreus a Canaã rs) é um processo doloroso e às vezes dispendioso (de tempo e recursos físicos). P2V (Physical to Virtual): É usado quando você quer transformar uma máquina física para virtual (Migração de um PC ou notebook para um virtualizador – ex. Xenserver); V2V (Virtual to Virtual): É usada quando você quer transformar uma máquina virtual em outra virtual (geralmente quando se vai migrar Vms entre Virtualizadores distintos – ex. Vmware-&gt;Xenserver) Bem, em meus tutoriais gosto sempre de explicar o “estado da arte” ou o “alicerce” para construção de seu próprio conhecimento através de informações precisas e minuciosas do ponto estudado. Na minha cabeça, somente um how-to passo-a-passo, sem os porquês, torna-se meramente um “cale a boca e siga-me”. É por isso que, em quase todos os tutoriais que fiz, quando chego na parte da “mão na massa” posto links com os procedimentos. Se você consegue levantar questões a respeito do que queres fazer e planejar as soluções para tal, até um robô fará o passo a passo. Te garanto que se sempre seguir este princípio, sua vida mudará, pois os porquês se tornarão cada vez mais frequentes. Lembre-se disso. Bem, voltando, sem mais delongas, irei apresentar (em passos) como ocorre o processo de migração de uma máquina física ou virtual para uma VM no Xenserver 6. 5. Estes procedimentos são genéricos. Os softwares utilizados para realizar as operações podem ser vários. No final, colocarei tutoriais para você seguir que citam ferramentas úteis para a realização dos procedimentos.  Criar uma imagem do disco rígido da máquina;1. 1. Neste passo, geralmente se inicia um cd/usb de boot de algum programa de backup (clonezilla, G4L, etc) na máquina e é copiado o disco rígido inteiro, gerando uma imagem no final do processo. Essa imagem deverá ser guardada.  Criar uma VM com as mesmas características de CPU, memória RAM, disco rígido e SO (caso tenha template para ela na lista de templates do XenServer – caso contrário utilizar o template other media install). 2. 1. Esse passo é bem simples, só não instale nenhum SO na VM. Somente crie-a e deixe lá desligada.  Iniciar a VM por cd/usb de boot a partir do mesmo programa que fez backup da máquina de origem e restaurar essa imagem no novo disco que você acabou de criar para a VM. 3. 1. Quando o processo de restauração concluir, geralmente ocorre de a VM não conseguir iniciar ainda, pois as informações do initrd/grub (caso a máquina seja GNU/Linux) ainda estão apontando para o kernel antigo. Se a VM em questão não for GNU/Linux, então pule para o passo 5.  Atualizar imagem initrd, grub e caminhos dos discos no /etc/fstab4. 1. Nesta etapa, basicamente, você terá que montar todos os diretórios da VM em chroot a partir de um livecd/usb Linux e então criar uma nova imagem para o initrd.  Após isso, você terá uma VM funcional dentro do seu ambiente de virtualização Xenserver. Somente esses 5 passos são necessários para a migração V2V ou P2V Windows/GNU/Linux onde o destino é o Xenserver 6. 5 Passos adicionais são necessários para a otimização da VM, como a conversão da mesma de HVM para PV (modos de virtualização – se não sabe o que é isto clique aqui) e a instalação do xentools (drivers xen para Network/disco – se não sabe o que é clique aqui) Bem, como falei, esses são os passos genéricos para se subir uma VM em um ambiente de virtualização Xenserver onde a origem era uma VM advinda de um outro sistema de virtualização ou de uma máquina física. O PDF a seguir, originado de um colega (Germano Dias) da instituição onde trabalho (Universidade Federal do Ceará) irá embasar a parte prática de todas as informações que repassei neste fluxo. Nele é usado o software Clonezilla (GPL) para realizar o backup e restore dos discos. Baixe aqui o PDF. Outros tutoriais podem servir como complemento ou até alternativa para esse procedimento: Tutorial usando o comando dd: http://www. lewan. com/blog/2011/04/14/p2v-conversion-of-linux-virtual-machine-for-xenserver Outro tutorial usando o clonezilla: http://www. ibm. com/developerworks/br/library/l-clonezilla/ Você pode usar também o programa G4L Ghost 4 Linux para backup do disco (em alternativa ao clonezilla) e que vem no pacote Hiren’s bootCD 15. 2: http://www. hiren. info/pages/bootcd Bom, espero que tenham gostado e até a próxima! Dúvidas e sugestões serão bem vindas! Abraços!   Referências: http://www. ibm. com/developerworks/br/library/l-clonezilla/ http://www. lewan. com/blog/2011/04/14/p2v-conversion-of-linux-virtual-machine-for-xenserver http://www. ppgia. pucpr. br/~jamhour/RSS/TCCRSS08A/Diego%20Lima%20Santos%20-%20Artigo. pdf http://www. hiren. info/pages/bootcd http://clonezilla. org/lecture-materials/015_OSC_Tokyo_Spring_2014/slides/OSC2014-Tokyo-Spring. pdf http://ports. marllus. com/wp-content/uploads/2016/02/GNU-Linux-P2V-e-V2V-para-XenServer-6. 5. pdf http://ports. marllus. com/2016/02/12/o-xenserver-tools-xenserver-6-5 http://ports. marllus. com/2016/02/12/pv-hvm-hvm-com-drivers-pv-pvhvm-pvh-no-xenserver-a-sopa-de-letrinhas-da-virtualizacao http://www. webartigos. com/artigos/quarenta-anos-da-caminhada-do-povo-de-deus-no-deserto/77137/    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional.   "
    }, {
    "id": 31,
    "url": "http://localhost:4000/tecnologia/2016/02/17/o-xenserver-tools-xenserver-6-5.html",
    "title": "O XenServer Tools – XenServer 6.5",
    "body": "2016/02/17 - Olá. Td bem? Bem, o que é o XenServer Tools? Xen Tools (carinhosamente apelidado) é um pacote de drivers de rede e disco paravirtualizados. Existe tanto a versão para Guests Windows quanto GNU/Linux e o XenServer já traz, por padrão, este pacote habilitado para ser instalado em uma VM com alguns destes sistemas operacionais instalados (e suportados). O Xen Tools é importante? Sem dúvida. Neste tópico falei muito sobre virtualização completa e paravirtualização. Mas, complementando este assunto, o Xen Tools contém drivers paravirtualizados de disco e rede, o que muito contribui no aumento de performance destas VMs no que diz respeito ao acesso ao disco virtual (vDisk) e transmissão/recepção de tráfego de rede. Tenho que instalar, obrigatoriamente, o Xen Tools? Você, absolutamente, não é obrigado a instalá-lo em uma VM recém criada (e nem eu vou lhe denunciar à Citrix porque você se recusa), mas, saiba que se esta VM tiver suporte para essa instalação, você estará deixando de ganhar bastante performance. E quais SOs das VMs são suportados para instalar o Xen Tools? Todas as versões dos SOs que contém na lista de templates disponíveis no XenServer. A lista destes sistemas operacionais está disponível aqui (http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#creatingVMs_supported_OS_minimums) As instruções para instalação do Xen tools em Windows e GNU/Linux está disponível aqui (http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-installtools. html)   Referências http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#creatingVMs_supported_OS_minimums http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-installtools. html http://ports. marllus. com/2016/02/12/pv-hvm-hvm-com-drivers-pv-pvhvm-pvh-no-xenserver-a-sopa-de-letrinhas-da-virtualizacao "
    }, {
    "id": 32,
    "url": "http://localhost:4000/tecnologia/2016/02/17/instalacao-xenserver.html",
    "title": "Instalação XenServer",
    "body": "2016/02/17 -  Olá!  Neste tutorial, guiarei você no processo de instalação do XenServer.  Pois bem, primeiro de tudo é preparar a mídia de boot do XenServer. Você pode instalá-la em um CD/DVD pendrive, basta baixar a imagem . iso de instalação do mesmo e gravá-la na mídia em questão. Neste tutorial, iniciarei os procedimentos como se estivesse gravando a mídia em um pendrive através de um sistema operacional GNU/Linux, como creio que hoje o acesso a esta mídia é muito mais facilitada do que as antigas (e dispensando o serviço do estagiário de ir comprar na esquina o CD/DVD virgem pra você, rs).  Seguem os passos:  Pré requisitos e recomendações de hardware:      &#8211; Um ou mais CPU(s) 64-bit x86, mínimo de 1. 5GHz.   É recomendado 2 GHz ou superior.  OBS:Para suporte de VMs Windows, CPU com suporte às tecnologias Intel VT or AMD-V 64-bit x86 é requerido.      &#8211; RAM: Mínimo de 2GB. Recomendado 4GB ou mais.      &#8211; Disco rígido: Armazenamento local (PATA, SATA, SCSI) de 16GB é o mínimo requerido. Recomenda-se um disco de tamanho a partir de 60GB local ou SAN HBA (exceto via software) se instalado com multipathing boot SAN. OBS: A instalação do Xenserver no host produz duas partições de 4GB no disco onde será instalado.      &#8211; Rede: Mínimo de 100Mbit/s ou superior. Uma ou mais NICs gigabit são recomendadas para aumentar a velocidade de P2V, exportação/importação e migrações ao vivo de VMs, etc.  Passo a passo da instalação:  Baixe a imagem de instalação do XenServer neste link: http://downloadns. citrix. com. edgesuite. net/10175/XenServer-6. 5. 0-xenserver. org-install-cd. iso  Após baixar a imagem para o seu computador, conecte o pendrive e execute o passo abaixo:  OBS: onde você vai substituir o /dev/sdX pelo caminho do seu pendrive (ex: se você tiver dois discos na sua máquina e adicionar o pendrive, você provavelmente terá estes dispositivos: /dev/sda (primeiro disco), /dev/sdb (segundo disco), /dev/sdc (pendrive, aêêêê)). Confirme o caminho do seu pendrive e execute o seguinte comando no terminal:  # sudo dd if=XenServer-6. 5. 0-xenserver. org-install-cd. iso of=/dev/sdX  Deve demorar uns 4-5min (em um core i7) até completar a gravação, aproveite para ir ao banheiro ou conversar um pouco na copa com as #amigas!  Próximo passo: espete o pendrive na máquina onde será instalada o XenServer e &#8220;mande brasa&#8221; no boot!  Brevemente você verá esta tela, quando o boot da mídia começar:  Após alguns segundos de letras pretas descendo na tela, você verá esta tela:  OBS: Como estava sem tempo de fazer a instalação do XenServer 6. 5 e não achei na net nenhuma imagem do procedimento, coloquei prints da instalação de um XenServer 6. 2 (que encontrei na net), mas, não se preocupe pois são as mesmas imagens de instalação do XenServer 6. 5 (a não ser pela frase &#8220;Version 6. 2. 0 (#70446c)&#8221; na parte de cima da imagem).  Escolha, então, o teclado &#8220;[qwerty] br-abnt2&#8221; e clique em &#8220;Ok&#8221;.  Após isso aparecerá a seguinte tela:  Explicando:  O texto diz que a ferramenta de instalação pode ser usada tanto para instalar um XenServer ou atualizar (upgrade) uma instalação de XenServer já existente e que a instalação nova vai apagar todos os dados existentes no disco (novidade! tsc…) e que para sua segurança é melhor ter um backup antes de proceder. O legal é que você pode também carregar drivers de algum periférico &#8220;desconhecido&#8221; da máquina (isso pode acontecer caso não tenha seguido os pré requisitos do HCL &#8211; Lista de Compatibilidade de Hardware).  Praticando:  Simplesmente, pressione a tecla &#8220;Ok&#8221;.  A seguinte tela é mostrada:  Explicando:  O texto diz que será criado um repositório de armazenamento, e te dá a opção de criar agora ou não. Em cenários de recuperação de ambiente perdido, geralmente não marcamos disco para ser repositório de armazenamento, pois quando você faz isso, tudo dentro deste disco é apagado.  A outra opção quer saber se você quer habilitar o &#8220;thin provisioning&#8221; e que a mesma serve para otimizar o armazenamento para utilização do XenDesktop (plataforma de virtualização de desktops (VDI) da Citrix).  Praticando:  Como não estamos (ainda, rsrs) fazendo nenhum teste de recuperação de dados, marque a primeira opção, habilitando o disco para ser o repositório de armazenamento. Se tiver mais de um disco e quiser marcá-lo também, fica a seu critério, lembrando que como o XenServer utiliza LVM (Logical Volume Manager) (por padrão) para realizar a operação de criação e gerenciamento do armazenamento local, você pode adicionar ou remover discos facilmente depois de o sistema ser instalado, inclusive.  Explicando:  Se seu plano é criar/salvar as VMs em repositórios de armazenamento do tipo externo (SAN (iSCSI, FC), NAS (NFS)) você só precisa se preocupar em utilizar um disco interno, que será a instalação do XenServer e SR local (repositório de armazenamento ou Storage Repository).  Lembrando que é neste passo que você vai ver os discos já em RAID (via hardware, se você tiver feito). Quanto ao software RAID, oficialmente o XenServer 6. 5 não suporta a característica, mas, como o &#8220;por baixo&#8221; dele é GNU/Linux (CentOS) você pode seguir, por sua conta e risco, diversos tutoriais ensinando como fazer raid via software após a instalação do XenServer. Lá em baixo coloquei uns links para alguns tutoriais desse tipo.  Praticando:  Desmarque a segunda opção (Enable thin provisioning…), pois não estamos aqui em um ambiente XenDesktop e habilitá-la não surtiria efeito algum.  Após isso, clique no &#8220;Ok&#8221; e verá a próxima tela:  Explicando:  É perguntado aqui onde está a mídia de instalação. Lembrando que você pode também selecionar para instalar por HTTP ou FTP ou NFS (Servidor de rede em um PC com a imagem . iso do XenServer!).  Praticando:  Neste caso, você vai clicar em &#8220;Local media&#8221;, pois nosso sistema está no pendrive. Selecione a opção e clique em &#8220;Ok&#8221;.  Próxima tela:  Explicando:  Aqui é perguntado se você quer instalar algum &#8220;suplemental packs&#8221;. Exemplos de supplemental pack é a integração do sistema de container Docker com o XenServer 6. 5 SP1. Supplemental packs geralmente são fornecedos pela Citrix (drivers, ferramentas adicionais para o XenServer…) e por terceiros (geralmente plugins de monitoramento e gerenciamento do XenServer).  Praticando:  Não iremos instalar nenhum pack suplemental aqui, então clique em &#8220;No&#8221;.  Próxima tela:  Explicando:  Aqui é perguntado se você quer testar a mídia de instalação. Geralmente, por pressa, selecionamos para pular esta verificação, mas, por experiência própria, sempre é bom testar a mídia antes de instalar, pois alguns problemas podem acontecer com a pós instalação, fazendo com que você nem desconfie dela própria (no nosso caso o pendrive). #ficadica  Praticando:  Clique em &#8220;Verify installation source&#8221;.  Após isso teremos o teste se realmente a mídia de instalação está em perfeita ordem e vai copiar direitinho os arquivos (reduzindo o custo de um futuro troubleshooting).  Depois vem a tela para configuração de acesso ao XenServer:  Praticando:  Aqui é mais fácil ainda, defina a senha de root do sistema. Ela será usada quando conectado diretamente ao XenServer via SSH ou via XenCenter.  Próxima tela:  Praticando:  Aqui você deve definir o nome do host XenServer e os campos de DNS. Tudo fica a seu critério. Atente para colocar nomes que vão lhe gerar uma possível organização, como xenprd01, xenhml02, etc.  Próxima tela:  Praticando:  Agora é a fase de &#8220;batismo&#8221; do seu XenServer. Nesta primeira tela você pode escolher o continente onde você estará (America or not? rs) para efeito de fuso horário.  Na próxima tela:  Praticando:  Agora é registrar a certidão de nascimento escolhendo o seu local! Escolha seu estado, caso não tenha na lista, escolha um mais próximo e com o mesmo fuso horário.  Próxima tela:  Explicando:  Atentai bem para esta tela, caro irmão(ã)!! De preferência, sugiro adicionar um servidor NTP que realmente funcione! Cuidado com entradas manuais de tempo e servidores de tempo bugados! Já tive problemas grandes em um XenServer em produção por conta disso! Até descobrir o problema eu já tinha efetuado várias atualizações e re-instalações!  O problema em se ter hosts XenServer desatualizados é porque afeta a sincronização entre estes mesmos hosts em um pool. Por exemplo, se você tem um cenário de hora desatualizada nos seus servidores XenServer e fizer uma alteração simples no ip da placa de gerência ou storage em um deles pode comprometer a sincronização da mudança entre os outros, gerando um efeito não muito agradável para o seu ambiente (não pague pra ver)!  Praticando:  Adicione algum servidor NTP que você tenha, caso não saiba, use os servidores NTP do ntp. br:  a. ntp. br  b. ntp. br  Próxima tela:  Instalando o sistema base…. .  Próxima tela:  Caso veja esta tela, show, o sistema foi instalado com sucesso!  Praticando:  Clique em ok!  O computador agora vai reinicializar!  Próxima tela:  Tela de inicialização do XenServer…  Próxima tela:  Pronto, você está na tela padrão de entrada de console do XenServer! Aqui você pode encontrar várias informações sobre a instalação, como o menu &#8220;network and management interface&#8221;, &#8220;Disk and Storage Repositories&#8221;, &#8220;Hardware end Bios Information&#8221;, informações sobre as VMs rodando no servidor no menu &#8220;Virtual machies&#8221;. Na lateral direita você tem informações a respeito da placa de rede definida para a gerência, os IPs atribuídos e características da máquina física onde foi instalado o XenServer, neste caso está aparecendo &#8220;Vmware, Inc&#8221; pois o XenServer foi instalado já de forma virtualidade em um servidor Vmware (isso é chamado de NESTED Virtualization [rodar um hypervisor dentro de uma VM] &#8211; Lembrando que o XenServer também fornece esse tipo de virtualização &#8211; você pode instalar um vmware dentro dele &#8211; e isso é usado geralmente para testes pois neste modo o desempenho do hypervisor é degradado).  Até aqui é isso!  Abraços e qualquer coisa poste aí nos comentários que lhe respondo!  Referências:  https://blog. trendelkamp. net/2015/02/configure-software-raid-xenserver-6-5/  http://djlab. com/2014/03/xenserver-6-2-with-software-raid/  http://docs. citrix. com/content/dam/docs/en-us/xenserver/xenserver-65/xenserver65sp1_installation_guide. pdf  http://docs. citrix. com/content/dam/docs/en-us/xenserver/xenserver-65/XenServer-6. 5. 0_QuickStartGuide. pdf  Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 33,
    "url": "http://localhost:4000/tecnologia/2016/02/17/importacaoexportacao-de-vms-no-xenserver-6-5.html",
    "title": "Importação/Exportação de VMs no XenServer 6.5",
    "body": "2016/02/17 - Olá, td bem? Hoje o tema é sobre exportação e importação de VMs no XenServer. Para exemplificar os formatos aceitos na exportação, vou colocar cada um como tópico e logo abaixo as situações preferidas para utilizá-lo. OVA/OVF (Formatos abertos – muitos hypervisors o utilizam):  – Compartilhar vApps e VMs com outros plataformas de virtualização que suportam OVF; – Salvar mais que uma VM de uma vez; – Garantir um vApp ou VM de corrupção e falsificação; – Simplificar a distribuição de um vApp armazenando um pacote OVF em um arquivo OVA;XVA (Formato do próprio XenServer – também aberto):    – Compartilhar VMs com versões do XenServer anteriores à 6. 0 (mas que também funciona em versões posteriores);   – Importar/Exportar VMs por meio de scritps via linha de comando (CLI);  Importação e exportação de VMs pode ocorrer entre hypervisors XenServer bem como de outros hypervisors para o XenServer. Quando você for importar para o XenServer uma VM que foi exportada de um outro hypervisor (ex. VMware, Hyper-V, VirtualBox, etc. ) você terá que rodar um sistema de verificação e correção de erros de boot que vem por padrão oferecido pelo XenServer. Basicamente é uma . iso chamada “Operating System Fixup tool”. É ela que tentará garantir a interoperabilidade (compatibilidade) no boot de uma VM “estrangeira” dentro do XenServer. Mas, que tipo de bruxaria essa ferramenta de Fixup faz com as VMs? “Simples”, quando a VM é iniciada, arrancando a . iso no boot, a ferramenta Fixup vai ver qual o sistema operacional da VM, se Windows ou GNU/Linux. Caso seja Windows, a ferramenta vai selecionar drivers genéricos críticos de boot da própria base de dados do sistema operacional e registrar para o boot da VM. Caso seja GNU/Linux, a ferramenta vai entrar no arquivo do GRUB e alterar as referências para os discos de inicialização de SCSI para IDE (ex. /dev/sda1 -&gt; /dev/hda1). Outra coisa que a ferramenta faz é retirar ou desabilitar ferramentas de boot ou virtualização vindas de outros hypevisors e que podem comprometer o desempenho no XenServer. OBS: Neste caso do Fixup, a VM é readequada, não convertida. Outra informação importante é que em cada processo de importação ou exportação de uma VM como OVF/OVA e/ou imagem de disco (VHD e VMDK) entre o Xenserver e o local onde estão os arquivos, é feita uma intermediação entre a cópia origem-destino. Como assim? Sempre que uma VM, neste caso citado, é importada ou exportada, é criada uma VM (chamada “TransferVM”) para receber os dados do(s) disco(s) dela, aos poucos estes dados vão sendo transferidos para o disco/arquivo de origem. Pense na TransferVM como um firewall que filtra tudo que está passando entre uma origem (que pode ser um SR no Xenserver) e destino (que pode ser um compartilhamento NFS). Para import/export de VMs entre repositórios remotos, você deve configurar os parâmetros de network que aparecerá na tela para TransferVM. Caso o import/export seja localmente (de uma VM para um repositorório local do XenServer) a TransferVM é criada mas não é pedido nenhum IP. Ele já assume que está na mesma network. Para saber como realizar importação, exportação, conhecer detalhes dos formatos disponíveis e configurações extras, pode clicar neste link (http://docs. citrix. com/en-us/xencenter/6-1/xs-xc-vms-exportimport/xs-xc-vms-exportimport-about. html). Vídeos sobre procedimentos: Citrix Xenserver VM Import and Export: https://www. youtube. com/watch?v=XcHbOF-D-l0 Citrix XenServer – Step by Step – 5. part -Import &amp; Export Virtual machine: https://www. youtube. com/watch?v=nZ4D0w0V8g8 Citrix XenServer 6 – Copying, Importing, Exporting, and Moving VMs: https://www. youtube. com/watch?v=E5KnWR2JbrU Importando uma Máquina Virtual (VM) no Citrix XenCenter: https://www. youtube. com/watch?v=qhtBQgy-vmA Citrix XenServer VM-Export: https://www. youtube. com/watch?v=OWaca8gEIJ8   Referências: http://docs. citrix. com/en-us/xencenter/6-1/xs-xc-vms-exportimport/xs-xc-vms-exportimport-about. html http://support. citrix. com/article/CTX124961 https://www. youtube. com/watch?v=XcHbOF-D-l0 https://www. youtube. com/watch?v=nZ4D0w0V8g8 https://www. youtube. com/watch?v=E5KnWR2JbrU https://www. youtube. com/watch?v=qhtBQgy-vmA https://www. youtube. com/watch?v=OWaca8gEIJ8  Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 34,
    "url": "http://localhost:4000/tecnologia/2016/02/17/fast-clone-e-full-copy-de-vms-no-xenserver-6-5.html",
    "title": "Fast clone e full copy de VMs no XenServer 6.5",
    "body": "2016/02/17 - Opa, e aí, td certo? Hoje explicarei sobre Fast Clone e Full Copy de VMs e templates. Meu papo será focado no entendimento destes dois pontos. Se você nunca copiou uma VM ou template, a qualquer hora irá precisar fazer isto. VMs e templates são copiados a fim de vários motivos: Para realizar testes a partir de uma VM que está em produção, provisionar (subir) novas VMs rapidamente, criar templates a partir delas, etc. Mas, quando você vai copiar uma VM pelo XenCenter, sempre abre uma tela que te pergunta dois modos de cópia para você escolher: O fast clone ou o full copy. Bem, quando você olha o nome fast clone dá uma ideia de mais agilidade (rapidez). Creio que muitos administradores escolhem essa opção por isso, sem saber que podem pagar caro no futuro… Explicando mais detalhadamente: Quando uma VM ou template é copiado pelo modo fast clone, o novo VDI da VM/template acessa os blocos antigos do VDI de origem. Por exemplo, se eu tenho uma VM com o GNU/Linux Ubuntu recém instalado e copiar esta VM como fast clone, a nova VM criada vai usar os blocos antigos (neste caso a partição do sistema completo) do disco da VM original, todo arquivo criado ou alterado a partir desse momento será gravado no novo disco. Em outras palavras, toda região do VDI da nova VM referente ao que foi gravado na VM original é um ponteiro para o disco desta VM (não há duplicação de conteúdo, em nível de bloco). Quando uma VM ou template é copiado como full copy, o novo VDI da VM/template é totalmente independente do VDI original (que foi copiado). Todo o conteúdo é copiado (literalmente) para o novo disco. Dá pra imaginar que essa cópia é um pouco mais demorada, por esse fato. Mas o preço a se pagar pela rapidez do fast clone, é a questão do encadeamento (acorrentamento) dos VDIs. Por padrão, o limite máximo desta cadeia (chain) é de 30 VDIs. Na prática, se você chegar em mais da metade desse limite, o acesso aos dados será bastante degradado. Essa cadeia vai aumentado a partir do momento que você vai provisionando cada vez mais VMs e copiando templates como fast clone. Por contrapartida, isso não ocorre com o método full copy, pois não existirá ponteiros entre VDIs novos e antigos nem encadeamento entre eles (chain=0). Vou explicar com imagens: O que acontece no fast clone:   O que acontece no modo full copy: Para você analisar essas árvores que são criadas e que crescem a partir do provisionamento de cada vez mais cópias fast, entre no host xen em questão e digite o comando: # vhd-util scan -f -m “VHD-*” -l VG_XenStorage- -p O resultado deste comando será algo do tipo: Perceba que a seta indica que o VHD (VDI) mostrado na linha tem um parent (nó de origem). Quando o parâmetro “parent” está como “none” quer dizer que o VHD não tem um pai relacionado, ou seja, ele não foi criado com fast clone. Assim como os snapshots, quando um VDI na cadeia é excluído, um evento de aglutinação (chamado coalescing) entre VDIs é feito (em qualquer tempo – assíncrono). Após isso, algum espaço em disco no SR deverá ser liberado. Mas, se você não quer excluir VMs encadeadas, existem três formas de resolver o problema do “encadeamento infeliz”: – Migrar a VM encadeada para outro SR no pool. Após isso o parâmetro parent será resetado (=none). – Setar a prioridade de IO de disco (QoS) da VM encadeada como nível alto (use isto como um paleativo). Mais detalhes aqui. – Copiar a VM encadeada novamente (Xencenter ou “vm-copy” na linha de comando), mas, desta vez como full copy (o parent também irá resetar). Bem, creio que você agora deve entender mais sobre esses dois tipos de cópias e seus prós e contras. Para saber como realizar os procedimenos de cópia, clique neste link (http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms/xs-xc-vms-copy. html)   Referências: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#disk_qos http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms/xs-xc-vms-copy. html http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#id541790 https://www. citrix. com/blogs/wp-content/uploads/2012/05/vhd-util-sample-1024×404. png    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 35,
    "url": "http://localhost:4000/tecnologia/2016/02/17/entendendo-templates-xenserver-6-5.html",
    "title": "Entendendo templates – Xenserver 6.5",
    "body": "2016/02/17 - Olá, td bem? O assunto agora é sobre templates. Template =&gt; modelo, padrão; Uma VM é um recipiente de software (muitas vezes chamada de Guest) que contém informações a respeito de CPU, sistema operacional, memória RAM e recursos de rede. Esta VM funciona “em cima” do hypervisor Xen. Pois bem, um template nada mais é que uma VM encapsulada em um arquivo e que contém todas as informações (metadados) para seu rápido provisionamento. Por exemplo, uma destas informações pode ser o tamanho padrão do disco rígido que irá ser criado para ela, ou o máximo de RAM que poderá ser atribuída a ela ou quantos CPUs a VM terá. com estas informações, a criação de VMs fica muito mais rápida para o administrador. Outro benefício é que, além dos templates padrão que o XenServer disponibiliza de vários sistemas operacionais, você também pode criar/deletar outros novos templates. Mas, por que devo criar templates se o XenServer já me disponbiliza vários? Te respondo com um exemplo: Você criou uma VM e teve o maior trabalho para configurar certinho um LAMP (Linux+Apache+MySQL+PHP). Tempos depis, na empresa que você trabalha você foi solicitado para entregar uma máquina com estas mesmas configurações. Neste caso, não é preciso criar a VM e configurar na unha todos os serviços novamente. Basta gerar um template a partir da VM que você criou (e no momento após a configuração de todos os serviços). Daí, a partir deste template, você criará (replicará) uma VM idêntica à original, depois é só alterar o nome dela, alterar o IP ou outras configurações e entregar ao setor que a solicitou. Massa né? A figura abaixo mostra qual as características dos templates e como podem ser usados, com base no exemplo que usei.   Existem 4 formas de se criar templates no XenServer, através do XenCenter: – Fazendo a cópia de um template existente; – Convertendo uma VM existente em um template (olha o exemplo que citei); – Salvando uma cópia de um snapshot de uma VM em um template; – Importando um template de uma VM (em arquivo . xva) que foi exportado de um template existente ou snapshot de uma VM; Todo o procedimento de cada um dos passos é descrito neste link (http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms/xs-xc-templates-new. html). Qualquer dúvida, só postar nos comentários ou no fórum xen-br@googlegroups. com. Existe como também você editar templates existentes no XenServer (como os templates prontos que já vem por padrão no XenServer). Por exemplo, neste artigo da Citrix (http://support. citrix. com/article/CTX126320) é descrito como você pode alterar o limite máximo de memória suportada para uma VM, que no caso do artigo, era de no máximo 16GB. OBS: Um ponto importante para ser dito é sobre a questão da cópia de um template ou de uma VM existente (primeira opção na lista de ser criar templates que citei acima). Nesta cópia existem dois mecanismos: A cópia completa (full copy) e a clone rápido (fast clone). Muito cuidado ao copiar como fast clone. Eu recomendo antes de o fazer, saber usá-lo e evitar futuras dores de cabeça. Para complementar, recomendo a leitura deste tutorial, onde explico sobre os tipos de snapshots. Abraços e até+!   Referências: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms/xs-xc-templates-new. html http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html http://support. citrix. com/article/CTX126320 http://blogs. citrix. com/2012/05/03/creating-vms-from-templates-in-xenserver-creates-a-fast-clone/    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 36,
    "url": "http://localhost:4000/tecnologia/2016/02/17/docker-no-xenserver-6-5.html",
    "title": "Docker no XenServer 6.5",
    "body": "2016/02/17 - Olá, td bem? Esse post é sobre Docker, porém, como o objetivo desta série de tutoriais do “Guia Zen do XenServer” é falar sobre XenServer e virtualização não vou explicar o porquê de utilizar containers e a importância de sua aplicação em ambientes de desenvolvimentos de software, mesmo sabendo que docker (o “boom” do momento) é bem importante e cada vez mais utilizado por grandes empresas. Se você quiser entender o que é Docker e containers, veja esse vídeo que explica sobre o assunto: https://www. youtube. com/watch?v=0cDj7citEjE É importante ressaltar também que o XenServer consegue gerenciar instalações Docker em VMs dentro do seu ambiente de virtualização. Consequentemente, o docker, neste caso, ainda vai ter o overhead do hypervisor, pois ele não é instalado direto no hardware, como exemplifica o conceito de container. Informações a respeito dos benefícios de se gerenciar Docker pelo XenServer (diretamente pelo XenCenter) e o passo a passo sobre como instalar o “Container Management Supplemental pack” (pack de software para gerenciar docker) para permitir todo o resto além da instalação do coreOS (e outros Guests), está disponível nestes links: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-container-manage. html http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#container_management Um vídeo interessante que demonstra a integração do Docker no Xenserver. https://www. youtube. com/watch?v=sUBluy3u3Mo Abraços e até+!   Referências: https://www. youtube. com/watch?v=0cDj7citEjE http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-container-manage. html http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#container_management https://www. youtube. com/watch?v=sUBluy3u3Mo    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 37,
    "url": "http://localhost:4000/tecnologia/2016/02/17/dmc-dynamic-memory-control-xenserver-6-5.html",
    "title": "DMC – Dynamic Memory Control – XenServer 6.5",
    "body": "2016/02/17 - E aí, tb bem? Você já deve ter visto esse intervalo mínimo e máximo de memória que é mostrado no XenCenter (nas configurações de memória RAM de uma VM). Talvez, possa até ter imaginado que o XenServer vai disponibilizar memória para uma VM de acordo com este intervalo, não é verdade? É isso mesmo que acontece. Isso é o controle dinâmico de memória (DMC – Dynamic Memory Control). As vezes chamado de “dynamic memory optimization”, “memory overcommit” ou “memory ballooning”. Quando o DMC é habilitado nas VMs, acontece o seguinte: Se tiver muita memória RAM sobrando no host xen físico, ele libera mémoria máxima para cada VM, ou seja, o valor máximo de memória que você definiu no intervalo é dado a ela (e as VMs ficam bem felizes com isso). Caso falte memória no servidor, o SenServer neste caso faz um cálculo e distribui uma fatia de memória (dentro do intervalo de memória definido em cada VM) para cada VM, não deixando nenhuma delas desamparada e também abrindo oportunidades de novas VMs serem criadas, pois sempre o XenServer irá fazer essas otimizações com o objetivo de todas serem alimentadas com memória suficiente para dar o boot (pelo menos). Bacana, não é? Show. Mas, como nem tudo são flores, ter este recurso habilitado requer o dobro de atenção na hora do planejamento de distribuição de memória entre as VMs de seu ambiente. Imagine a seguinte situação: Você tem 10 VMs com 1GB de ram funcionando no seu host xen (que tem 12GB de ram). Ou seja, até então você tem pouca memória disponível no seu Dom0 (Xen Hypervisor). Daí você vai criar mais duas VMs de 1GB de ram, então, por causa do DMC ativado em cada VM, o XenServer vai reduzir a memória de cada uma delas afim de ter memória disponível para essas duas VMs novas. Mas, esse ambiente pode entrar em colapso (elas travarem) se as VMs ficarem sem memória suficiente para funcionar, além da memória reservada para o Dom0. Então, tenha bastante cuidado no limite mínimo que você vai colocar para sempre sobrar memória disponível no servidor físico, e assim poder utilizar esse recurso tão bacana sem efeitos colaterais. Os passos para habilitar/desabilitar o DMC em uma VM, bem como definir um tamanho fixo de memória para ela, está disponível neste link (http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-memory/xs-xc-dmc-edit. html) Referências: http://www. thegenerationv. com/2010/04/xenserver-56-preview-part-1-dynamic. html http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-memory/xs-xc-dmc-edit. html    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 38,
    "url": "http://localhost:4000/tecnologia/2016/02/17/criando-vms-maquinas-virtuais-no-xenserver-6-5.html",
    "title": "Criando VMs (Máquinas Virtuais) no XenServer 6.5",
    "body": "2016/02/17 - Olá, Hoje guiarei você no processo de criação de uma máquina virtual no Xenserver. Para isso, utilizaremos o XenCenter. Vamos lá. Abra o Xencenter, selecione o pool ou XenServer onde você quer que a VM seja criada e vá no menu “VM” e clique em “New VM”. Após isso, quando abrir a janela do “New VM Wizard”, aparecerá uma opção para você escolher na lista um template disponível. Escolha um template referente ao sistema operacional que você instalará e clique em “Next”. Para saber mais sobre templates, clique AQUI. Após isso, digite um nome e descrição para a VM e clique em “Next”. ex: Nome: GNU/Linux Ubuntu Banco Producao Descrição: VM Linux ubuntu referente ao banco de produção da filial bla bla bla Agora, especifique qual mídia de instalação usará no processo. Você pode especificar um servidor NFS de rede com a ISO, usar o drive de CD/DVD do servidor físico, instalar através da URL (nfs, ftp, http) ou usar boot de rede (PXE network boot). Ao final, clique em “Next”. Na próxima etapa, você pode nomear um servidor físico à VM. Este servidor é que liberará os recursos de hardware (ram, network e CPU) necessários ao funcionamento desta. Esse passo é opcional quando você tem um pool, pois no final da criação o xenserver vai eleger um servidor ativo com recursos (hardware) disponíveis para subir a VM. Se você estiver criando a VM em um servidor específico, selecione o servidor e clique em “Next”. Caso queria deixar a escolha aleatória (pelo próprio Hypervisor), não marque nenhum servidor e clique em “Next”. Nesta etapa, selecione a quantidade de CPUs virtuais (vCPUs) e a quantidade de memória RAM da mesma. A partir da versão 6. 5 o XenServer disponibilidade agora, de forma intuitiva, a possibilidade de você configurar a topologia das vCPUs, como a escolha de quantos cores por socket a VM terá. Lógico, sempre respeitando o limite físico disponível, sob pena de perca de performance da VM. ex. 2 vCPUs com topologia 2 cores e um socket. 4 vCPUs com topologia 4 cores e 2 sockets ou 4 cores e 1 socket. Fica seu critério. Na próxima etapa, você irá realizar a configuração dos discos virtuais que a VM terá. Crie o(s) disco(s) e clique em “Next”. O último passo é configurar as placas de rede da VM. Por, padrão o xenserver já adicionará toda as placas disponíveis à VM. Você pode desvincular todas elas e deixar só a placa referente ao dhcp da sua rede, por exemplo. Pode realizar a customização do endereço MAC e definir QoS. Então, complete a configuração da VM definindo no campo de seleção abaixo se a mesma iniciará automaticamente após criada. Em alguns instantes (geralmente na espera de criação dos vdisks) a VM estará criada e prontinha para uso. Existem outros métodos usados para criação de VMs. Eles também são descritos na documentação oficial da Citrix, neste link: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#creatingVMs_overview É isso! Referências: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/guest. html#creatingVMs_overview http://www. howtogeek. com/57601/what-is-network-booting-pxe-and-how-can-you-use-it/  Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 39,
    "url": "http://localhost:4000/tecnologia/2016/02/17/criando-srs-storage-repository-no-xenserver-6-5.html",
    "title": "Criando SRs (Storage Repository) no XenServer 6.5",
    "body": "2016/02/17 - Olá, pessoa! Tudo bem com você? Bem, hoje falarei sobre os repositórios de armazenamento (SR – Storage Repository). Existem três tipos de mapeamentos de armazenamento físico (SR) para um VDI, são eles: VHD baseado em volume lógico (LVM) em uma LUN: Nesse caso, a LUN é fornecida como um dispositivo de bloco para o XenServer. Nesta LUN serão criados os VHDs que correspondem aos VDIs das VM’s. Os VDIs são representado como volumes e guardados em formato VHD. A conexão para a LUN pode ser através de Fiber Channel (SR do tipo LVMoHBA), iSCSI (SR do tipo LVMoiSCSI), SAS (SR do tipo LVMoHBA) ou ainda criada localmente no host XenServer (SR local do Tipo Local LVM). VHD baseado em arquivo em um sistema de arquivo: Nesse caso, o SR é criado a partir de algum compartilhamento NFS ou local (do tipo EXT). Neste SR, as VMs são criadas como VHDs, ocupando somente o espaço de escrita “naquele momento”, ou seja, são thin-provisioned. LUN por VDI: Neste caso, você espeta diretamente a LUN na VM. Então, a LUN será o próprio VDI da VM. Ela escreverá diretamente na LUN, que pode estar guardada em um storage SAN, por exemplo. Para resumir os três tipos de SR e em que casos são utilizados: SR Volume-Based: Local LVM, iSCSI/FC/SAS. SR File-Based: Local EXT, NFS. VDI é uma abstração de um Hard Disk Drive (Drive de disco rígido). O formato padrão dessa abstração é o VHD (Virtual Hard Disk), que é o mesmo padrão que a Microsoft utiliza para os discos virtuais no Hyper-v (Hypervisor que ela mantém). Nesse VHD contém tudo que um HDD conteria: tabelas de partições, metadados referentes ao tamanho do dispositivo de bloco, cilindros, etc. Como a Microsoft liberou as especificações desse padrão para a comunidade, o xensource (consequemente o Xenserver – a partir da versão 5. 5 update 2) o adotou para compor o formato padrão de VDI. Portanto, quando você criar um VDI ele será gravado, por padrão, no formato VHD. Além desse formato existe também o RAW (pior performance) que você pode escolher utilizando a linha de comando (apenas) do próprio XenServer. A menos que seja um caso específico, não recomendo utilizar raw. Com relação ao LVM e File, vai depender do tipo de armazenamento físico que você usará para ser SR no seu ambiente. Como falei anteriormente, se for utilizar iSCSI/FC/SAS ou uma partição local como LVM, você irá utilizar VHD em formato LVM. Porém, se utilizar um compartilhamento NFS como seu SR ou uma partição local formatada como EXT, os VHDs guardados nesses locais serão no formato de arquivo (File). Agora vem a pergunta: Qual a diferença do LVM para o File? Bem, se você não leu meu artigo sobre snapshots, recomendo que leia aqui. Mas, a diferença é que VDIs escritos em SR do tipo LVM são thick-provisioned. Já os escritos em SR do tipo File são thin-provisioned. Para entender como funcionam esses dois “modelos” de escrita em disco, recomendo a leitura sobre isso no blog do Cleriston: http://cleriston. com. br/post/19582513172/thick-or-thin-provisioning Quando eu estava escrevendo esse artigo, li sobre o lançamento da nova versão do Xenserver (7 – Dundee). Descobri que o mesmo vai vir com a opção de usar thin-provisioning em SR do tipo LVM. É um avanço, sem dúvidas (desde à versão 5. 5 a comunidade aguarda essa feature). Porém, muito cuidado ao utilizar thin-provisioning no lado do hypervisor, pois, lembre-se que o espaço consumido no SR sempre é o que está escrito nos discos virtuais do seu ambiente naquele momento, e nunca o tamanho total desses discos. Isso abre a possibilidade de você criar, sem problemas, discos de tamanhos que, se somados, podem passar do total da capacidade física. Imagine isso acontecendo e todos os discos virtuais atingindo sua capacidade máxima. Dados vão para o ar! Ou melhor: pro limbo. Cuidado. A descrição para a criação de vários tipos de SR está disponível na documentação oficial, a qual você pode conferir aqui: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-storage/xs-xc-storage-pools-add. html Grande abraço e espero que tenha ensinado de forma satisfatória sobre os pontos inerentes ao SR. Referências: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-storage/xs-xc-storage-pools-add. html http://support. citrix. com/article/CTX125884 https://en. wikipedia. org/wiki/Connectix http://serverfault. com/questions/277294/what-kvm-disk-type-to-use http://xenserver. org/discuss-virtualization/virtualization-blog/entry/xenserver-dundee-beta-1-available. html http://cleriston. com. br/post/19582513172/thick-or-thin-provisioning http://ports. marllus. com/2016/02/14/snapshots-no-xenserver-6-5 http://support. citrix. com/article/CTX138342    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 40,
    "url": "http://localhost:4000/tecnologia/2016/02/17/configurando-vms-no-xenserver-6-5.html",
    "title": "Configurando VMs no XenServer 6.5",
    "body": "2016/02/17 - Olá, tudo bem? Bem, pra não se tornar ambíguo postar como se faz modificações nas configurações de uma VM (sobre disco, rede e memória), coloco aqui os tutoriais oficiais Citrix para realizar diversas ações, separados pelo tipo de alteração. Configuração de memória: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-memory. html OBS: Explico sobre DMC (Controle dinâmico de memória) neste LINK Configuração de armazenamento virtual: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-storage. html Configuração da rede: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-network. html Configuração das propriedades da VM (vCPU, boot options, alertas…): http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-properties. html Gerenciamento de containers (Docker): http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-container-manage. html OBS: Explico sobre containers (Docker) neste LINK Por hoje é só. t+! Referências: [1] http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-memory. html [2] http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-storage. html [3] http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-network. html [4] http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-properties. html [5] http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-vms-configuring/xs-xc-vms-container-manage. html  Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 41,
    "url": "http://localhost:4000/tecnologia/2016/02/17/backup-no-xenserver-6-5.html",
    "title": "Backup no XenServer 6.5",
    "body": "2016/02/17 - E aí, tudo certinho? Bem, hoje o tutorial será sobre backup! Tão falado, mas tão pouco usado, o backup no XenServer parece ser complicado, mas é mais simples do que se imagina. Primeiro, existem três níveis de backup no XenServer: Pool: Esse backup guarda informações a respeito do pool, ou seja, o arquivo gerado por esse backup geralmente é bem pequeno e contém informações a respeito de quais Vms estão em cada host do pool, quantas NICs e quais os Ips dessas NICs, se tem VLAN configurada e quais os storages conectados a ele. Se você “crashar” um pool e ele se perder, esse aquivo permite você criar outro pool idêntico novamente. Host: Esse backup geralmente é bem grande e contém os dados escritos no disco local do host xen. Não é recomendado você guardar este backup dentro do próprio host, pois o mesmo é bem grande (dependendo da quantidade de dados escritos no disco local do próprio host). Esse backup é interessante quanto se quer ter a instalação do XenServer com todos os patches, updates e alterações em arquivos em diretórios do SO Dom0, ou seja, quando se quer ter o mesmo host xen idêntico ao que era antes, sem maiores trabalhos. A desvantagem disso é que o arquivo gerado será bem maior que um backup de pool. VM: Esse é o backup quando se quer tirar uma cópia/clone de uma VM. Geralmente se utiliza esse backup quando se quer guardar uma VM completa para ser importada em outro ambiente xenserver ou guardá-la para futuros backups. A vantagem desse procedimento é que, se você quiser uma VM consistente, terá que realizar um backup em um intervalo bem pequeno de tempo. Muitos administradores realizam esse tipo de backup uma vez no ciclo de vida de uma VM e, ao longo do tempo, vai realizando backup do SO (Bacula, por exemplo). O ideal é se planejar um backup utilizando todos esses níveis, para compor uma solução onde eu tenho tanto a agilidade de recuperação de uma VM, de um host e de um pool. Porém, muitas vezes por falta de recursos disponíveis (lê-se: espaço de armazenamento), elaboramos abordagens que se focam mais em backups de pool e Vms, pois a partir desses dois, pode se construir novamente um pool falhado. A janela de recuperação, nesse caso, será um pouco menor, mas, dependendo do nível de criticidade do ambiente, tende a ser aceitável. As possibilidades são inúmeras e se diferenciam para cada ambiente. O “know-how” do backup é definir o planejamento dele. Após isso, só passo-a-passo. Para compor sua solução open source de backup, sugiro pesquisar sobre o software Bacula: http://blog. bacula. org/about-bacula/what-is-bacula/ Os procedimentos para realização dos diversos tipos de backup no Xenserver está disponível na documentação oficial, a qual se encontra aqui: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#backups Abraços e espero que tenham gostado da explicação sobre os níveis de backup existentes no Xenserver! Referências: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#backups http://blog. bacula. org/about-bacula/what-is-bacula/    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 42,
    "url": "http://localhost:4000/tecnologia/2016/02/17/alta-disponibilidade-ha-high-availability-no-xenserver-6-5.html",
    "title": "Alta disponibilidade (HA – High Availability) no XenServer 6.5",
    "body": "2016/02/17 - E aí, leitor! Td bem? Bem, HA (High Availability – Alta disponibilidade) é um assunto bem procurado por administradores de infraestrutura, pois muitos o querem em seu ambiente (lê-se: seu pescoço), afim de deixá-lo o mais seguro e resiliente possível. Aliado a isto, o fato de esse recurso ser completamente open source (aêêêêê) no XenServer 6. 5, contribui bastante para sua adoção. A facilidade de configuração de HA coloca este recurso na lista dos top 10 mais utilizados no XenServer. Mas, em quê consiste o HA? Simples, este sistema tenta proteger seu ambiente (suas Vms) em caso de falhas físicas ou lógicas no host xen. E o que ele faz para tentar garantir isso? Ele tentará migrar as VMs do host xen falhado para algum host vivo (e de bem com a vida). Para isso, o HA faz uso do recurso XenMotion (falo sobre XenMotion aqui). Explicando o HA de forma mais completa: Os alicerces para o funcionamento do HA em um pool de recursos são: Planejamento da disponibilidade dos recursos, detecção da falha e execução da recuperação. Planejamento da disponibilidade dos recursos: Neste etapa, o HA irá planejar qual a tolerância de falha nos servidores (quantos servidores podem falhar) dentro do pool. Basicamente, baseado em quantas Vms você quer proteger dentro de cada host, o próprio HA emitirá um aviso informando qual o limite de servidores que podem falhar no pool para que essas Vms sejam ligadas em outros servidores ativos. Portanto, se você quiser ter resiliência total do seu ambiente, deixe sempre uma reserva de recurso (RAM e CPU) em cada host. Essa reserva será utilizada para alocar Vms de hosts que podem vir a falhar. Claro, o tamanho desta reserva vai depender de quantos hosts e quanto de recurso (RAM e CPU) você terá e quantas Vms você vai querer “salvar”. O HA sempre calculará, automaticamente, a quantidade de recursos disponíveis no pool para lhe dizer qual tolerância de falhas você tem naquele momento. Detecção da falha: Quando você for configurar o HA em um pool, o Xenserver vai pedir para escolher um SR onde ele irá gravar o keep alive dos servidores. Este será um SR compartilhado (no pool) chamado Heartbeat SR (que armazena o “batimento cardíaco” dos servidores – 356Mb tamanho). Ele nada mais armazena do que informações de status (vida [response] ou morte [timeout]) de cada servidor no pool. Em um intervalo de tempo, cada servidor fornece a informação que está vivo para este SR (keep alive). Se esta informação não chegar, o HA reconhecerá que o servidor morreu e tentará seguir o plano de recuperação das Vms (de acordo com o que você planejou). Pode acontecer de um host perder as configurações de rede, ou um bug no toolstack, ou um administrador descuidado retirar ou alterar o ip de gerência do host para uma faixa desconhecida. Nestes casos, a comunicação do host para o storage não foi perdida (ou seja, as Vms continuarão rodando normalmente), porém o host xen ficará inacessível. Para nossa alegria, o HA consegue detectar que houve falha na rede (sim, ele também checa de tempos em tempos a rede do host). Quando ocorre isso, entra em cena um recurso chamado host fencing, que vai desligar o host, e tentar recuperar as Vms protegidas associadas a ele, migrando-as para outro host com recurso disponível. Execução da recuperação: Acontece o que expliquei em tópicos anteriores. Se o host deixar de mandar um keep-alive para o storage ou se a rede de gerência do host for perdida (por algum motivo) iniciará o processo de recuperação das Vms, realizado pelo sistema de HA do XenServer. Nestes dois casos, o servidor estará indisponível e as Vms serão migradas para outro host disponível no pool de recursos. Resumindo (mais do que foi resumido): Na criação do HA, você seleciona quais Vms vão ser reiniciadas em caso de falhas (indicando qual a ordem de inicialização). Dinamicamente, o HA vai mostrando se ele tem condições de recuperar todas as Vms. É perguntado também qual a tolerância que você quer para falhas em servidores (configured failed capacity) e, automaticamente, o Xenserver vai te dizer se é possível ele garantir essa recuperação (current failed capacity). Lembrando que o valor do “current failed capacity” vai alterando dinamicamente de acordo com o provisionamento ou alteração de novas Vms no pool, pois, ao longo do tempo os recursos de RAM e CPU entram em escassez, podendo chegar no ponto em que os recursos de “sobra” nos hosts não sejam suficientes para garantir o plano de recuperação configurado pelo administrador (esse ponto é conhecido como overcomitted). Não se preocupe, o Xenserver enviará alertas automaticamente pelo Xencenter ou por e-mail (se configurado) quando o recurso físico disponível não suportar recuperar todas as Vms protegidas pelo HA. Então, fique atento! Resumindo (com imagens) com duas situações, uma com sucesso e outra sem sucesso no plano de recuperação (por causa de overcommitting):     Ciclo de vida do HA no Xenserver:     Requisitos e recomendações:  – Um pool de recursos, logicamente;   – Recomenda-se pelo menos 3 hosts nesse pool;   – Um SR compartilhado, sendo este do tipo NFS, iSCSI ou FC de pelo menos 356MB ou superior.  Destes 356MB serão: 4MB para dados do heartbeating e 256MB para metadados do membro master do pool, para os casos onde ele falhará.   A citrix recomenda que você utilize um SR dedicado para conter estes dados.   – IP estático para todos os hosts no pool;   Se o endereço de IP de um host mudar, provavelmente o HA considerará que a sua rede falhou e irá ativar o host fencing. Para remediar isto, basta desabilitar o HA (comando # host-emergency-ha-disable) e resetar o membro master do pool (comando # pool-emergency-reset-master) e só então reabilitar o HA.   – vDisks (discos virtuais) de VMs deverão estar em storages compartilhados;   – Vms não devem ter conexão ativas para unidades de DVD local do host xen;   – Vms devem ter interfaces de rede virtuais disponíveis em todo o pool;  Algumas considerações: – Update/Upgrade de Xenserver: Antes de qualquer procedimento deste tipo, desabilite o HA, pois, muito provavelmente seu servidor precisará ter seu XAPI ou kernel reinicializado. Você não quer que o HA entenda isso como uma falha, né? – Vms configuradas no plano de HA pela opção de best-effort não estão protegidas através do plano de recuperação de Vms do HA. Como o próprio nome já sugere (melhor esforço), o sistema do HA tentará alocar uma VM em um servidor onde haja espaço em recursos. Por isso, as VM com prioridades de reinicialização 0, 1, 2 e 3 são as únicas que estarão no plano de recuperação do HA. Então, fique de olho no que é serviço crítico em seu ambiente. – No planejamento de reinicialização, sempre é bom estabelecer tanto a prioridade quanto o delay das reinicializações. A primeira serve para definir quem irá rebootar primeiro (DHCP, AD, SAMBA, DNS, por exemplo) e o atraso entre estes reboots. Por exemplo, você não vai querer que o serviço de DHCP de sua rede entre depois de um serviço SAMBA, ou que uma aplicação que usa um compartilhamento do SAMBA ligue após o próprio SAMBA, não é? Fora isso, ainda tem o problema da “chuva de boots” que consiste no overhead do Dom0 para gerenciar o boot de muitas Vms ligando de uma vez. A “chuva de boots” pode comprometer o desempenho de seu ambiente de virtualização. – Considere utilizar multipathing na comunicação para seu(s) storages e configurar bond nas interfaces de rede de gerência de cada host no pool protegido por HA. Ter duplicação de caminhos para rede e armazenamento melhora, consideravelmente, a capacidade que o(s) host(s) têm de ficarem ativos em caso de falha em uma NIC (placa de rede). Isso reduz a probabilidade de ativação do HA (pois é isso que queremos, certo?). Bem, para finalizar, deixo aqui os passos (através de documentação oficial) necessários para habilitar o HA em um pool de Xenservers. http://support. citrix. com/article/CTX121708 Espero que tenha gostado do tutorial! Até mais! Referências: http://docs. citrix. com/en-us/xencenter/6-5/xs-xc-protection/xs-xc-pools-ha/xs-xc-pools-ha-enable. html http://support. citrix. com/article/CTX121708 https://xen-orchestra. com/blog/xenserver-and-vm-high-availability/ https://www. citrix. com/blogs/2011/05/18/so-what-is-xenserver-xapi/ http://wiki. xen. org/wiki/Choice_of_Toolstacks#XAPI_. 2F_XE    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 43,
    "url": "http://localhost:4000/tecnologia/2016/02/16/monitoramento-xenserver-6-5.html",
    "title": "Monitoramento – XenServer 6.5",
    "body": "2016/02/16 - Olá, hoje o assunto é sobre Monitoramento do ambiente de virtualização XenServer. O assunto é bem simples, mas pouca gente sabe o quão ampla é a gama de métricas que o XenServer consegue capturar no seu funcionamento. Por padrão, é mostrado no XenCenter, na aba “performance” do host ou VM, gráficos de utilização de memória RAM, network e CPU. Porém, você pode querer capturar outras méticas, como a quantidade de IOPS (Entra e saída por segundo) na escrita dos VDIs das VMs, a latência do disco ou rede de um host, dentre vários dados. Essas métricas são mostradas no Xencenter através de RRDs (Base de dados Roud Robin), que são arquivos que guardam diversos dados sobre as métricas de rede, CPU, RAM, Storage, etc. Caso você queira pegar esses RRDs para utilizar em outras ferramentas, pode também capturá-los via HTTP. Como é mostrado aqui: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#analyzing_rrds Você também pode querer adicionar o monitoramento de seu ambiente de virtualização em um software de monitoramento de ambiente, como o nagios ou cacti. Deixo um link aqui de um script para nagios para monitoramento de diversas informações em um pool de servidores XenServer. Ele é totalmente adaptável, abrindo facilmente a possibilidade de adição de novas métricas. https://exchange. nagios. org/directory/Plugins/Operating-Systems/*-Virtual-Environments/Others/Check-XenServer/details O conjunto de métricas disponíveis no Xenserver para serem capturadas tanto no Host quanto nas VMs está disponível na documentação oficial do XenServer, que pode ser vista aqui: http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#performance_monitoring Espero que tenha gostado da breve explicação. Qualquer dúvida, só chamar! Abraço. Referências: https://pt. wikipedia. org/wiki/RRDTool http://docs. vmd. citrix. com/XenServer/6. 5. 0/1. 0/en_gb/reference. html#performance_monitoring http://xenserver. org/partners/20-dev-hints/120-xs-pool-check-nagios. html https://exchange. nagios. org/directory/Plugins/Operating-Systems/*-Virtual-Environments/Others/Check-XenServer/details    Este trabalho de Marllus, está licenciado com uma Licença Creative Commons &#8211; Atribuição-CompartilhaIgual 4. 0 Internacional. "
    }, {
    "id": 44,
    "url": "http://localhost:4000/tecnologia/2016/02/07/hcl-xenserver.html",
    "title": "HCL Xenserver",
    "body": "2016/02/07 - O assunto aqui é sobre compatibilidade de hardware e XenServer. A Citrix mantém uma site (http://hcl. xenserver. org/) contendo todo o conjunto de hardware homologado por ela junto a diversos fabricantes de equipamentos, como Dell, HP, Supermicro, IBM. Todo equipamento que obteve êxito nesse teste é adicionado à essa lista de compatibilidade (HCL). &lt;/p&gt;  Mas, o que é essa tal de compatibilidade? Ela serve para oficializar que o XenServer vai conseguir &#8220;enxergar&#8221; (instalar os drivers) qualquer hardware que contenha na lista em questão.      Pois bem, quando você estiver elaborando um projeto de especificação de equipamentos (servidores, storages, placas de rede (NICs), etc. ) e quiser utilizar o XenServer neste ambiente, o primeiro passo é entrar no site (http://hcl. xenserver. org/) e procurar o hardware em questão no campo de busca do mesmo. Você poderá também selecionar algum tipo de equipamento e fazer a listagem dos homologados. Observe a imagem  do site abaixo que mostra esses duas opções que mencionei:  Mas, não se preocupe se o servidor onde você irá instalar o seu XenServer não está aí. Na verdade, necessariamente, isso não é um pré requisito para este fantástico virtualizador funcionar. Neste caso, ele poderá até reconhecer e instalar todos os drivers do equipamento mas não terá suporte oficial pela Citrix, se você tiver em mente de adquirir uma licença.  Recapitulando: Ter um hardware na HCL não é requisito para a total plenitude de funcionamento do XenServer neste ou conectado a este hardware (storages, servidores, NICs, etc. )!    Abraços e até mais!  Referências: http://hcl. xenserver. org/ "
    }, {
    "id": 45,
    "url": "http://localhost:4000/poesia/2015/12/18/quando-whatsapp-acabou.html",
    "title": "Quando o WhatsApp acabou",
    "body": "2015/12/18 - De manhã cedo, acordei…Peguei no celular, nenhuma notificação. Verifiquei o link de internet acessando um site qualquer. Estava beleza. O mito então era mesmo verdadeiro. Liguei pra um amigo, conversei sobre o projeto pra entregar e depois ele me contou uma estória que ocorrera com ele na noite anterior. Altos papos. Muitos risos para começar o dia. Banhei, nenhuma notificação, me arrumei, nenhuma notificação, tomei café, nenhuma notificação, assisti tv, nenhuma notificação, me preparei pra sair de casa e aquelea merda de notificação não vinha. Droga. Cadê a galera? Peguei o carro e alavanquei no trânsito infernal, daqueles que a gente pára a cada instante pra olhar o WhatsApp e trocar gaitadas nos grupos. Mas hoje não tinha ninguém, uma alma viva sequer. Cheguei no serviço e lembrei de um recado que precisava dar para minha mãe que mora em outra cidade. Em sequência, me veio o cancelamento do WhatsApp. Resolvi ligar e falar com ela. Fazia tempo que não ouvia sua voz, meiga e cheia de saudades de mim. Aquilo foi revigorante, de fato. Passei a manhã visitando as salas dos amigos de outros departamentos, que faziam parte do grupo do WhatsApp do trabalho. Falamos sobre o cancelamento do aplicativo e ao mesmo tempo sobre a futura confraternização da empresa. Aquele ambiente profissional, antes silencioso e quase sem nenhuma roda social (tocável), estava alegre e prazeroso de se falar, ironicamente, quase como um grupo virtual. Aproveitei e conversei com um carinha que não falava com ninguém (ou ninguém falava com ele). Aprendi seu nome e em qual projeto estava trabalhando. Ele já estava lá há 3 anos. Putz. Fomos almoçar. Imagine aí as brincadeiras e gargalhadas, os chats reais ativos…. que sensação aquela. Fazia anos que não a sentia. Desde aquela época em que sentávamos nas calçadas do bairro memorare. Uma reflexão, fatalmente, veio à tona. A comodidade de ações toma conta de nosso modo em grupo. A rapidez de um pálido “kkk” ou um emoticon chorando de rir nos emagrece socialmente. Todas aquelas pessoas com quem eu estava conversando pessoalmente, todos aqueles seres cheios de luz e energia olhando e mostrando verdadeiros “KKK’s”, era quase como não acreditar que estivesse acontecendo. Que louco, que hilário. Um tapa mais genuíno que já recebi na minha vida. E o mais interessante foi que me dei conta disso tudo em uma manhã. Era a consciência pré trauma de uma pós ultra rápida abstinência. De fato, revigorante. Tudo isso me fez repensar atitudes. Todo um turbilhão passava na minha cabeça. Era a hora. Hora de me desfiliar de grupos virtuais que tomavam conta do meu precioso dia. Hora de rasgar as amarras. Voltar à realidade tão bela. A conversar olho no olho. A sentir o choro do amigo molhando meu ombro. Olha aí, o Whats voltou. E aí galeeeeeeeerraaaa!!Boa noite, grupo. "
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});
function lunr_search(term) {
    document.getElementById('lunrsearchresults').innerHTML = '<ul></ul>';
    if(term) {
        document.getElementById('lunrsearchresults').innerHTML = "<p>Search results for '" + term + "'</p>" + document.getElementById('lunrsearchresults').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>No results found...</li>";
        }
    }
    return false;
}

function lunr_search(term) {
    $('#lunrsearchresults').show( 400 );
    $( "body" ).addClass( "modal-open" );
    
    document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal fade show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow-lg" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> <button type="button" class="close" id="btnx" data-dismiss="modal" aria-label="Close"> &times; </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-danger btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
    if(term) {
        document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><small><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></small></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
        }
    }
    return false;
}
    
$(function() {
    $("#lunrsearchresults").on('click', '#btnx', function () {
        $('#lunrsearchresults').hide( 5 );
        $( "body" ).removeClass( "modal-open" );
    });
});